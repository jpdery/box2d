(function(a){var b={},c=function(d){var e=b[d];if(!e){e=b[d]={};var f=e.exports={};a[d].call(f,c,e,f,window)}return e.exports};window.box2d=c("0")})({0:function(a,b,c,d){var e={};e.Vec2=a("1"),e.BodyDef=a("2"),e.Body=a("3"),e.FixtureDef=a("4"),e.Fixture=a("5"),e.World=a("6"),e.MassData=a("7"),e.PolygonShape=a("8"),e.CircleShape=a("9"),e.DebugDraw=a("a"),b.export=e},1:function(a,b,c,d){var e=function(a,b){arguments.length==2&&(this.x=a,this.y=b)};e.Make=function(a,b){return new e(a,b)},e.prototype.SetZero=function(){this.x=0,this.y=0},e.prototype.Set=function(a,b){this.x=a,this.y=b},e.prototype.SetV=function(a){this.x=a.x,this.y=a.y},e.prototype.GetNegative=function(){return new e(-this.x,-this.y)},e.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},e.prototype.Copy=function(){return new e(this.x,this.y)},e.prototype.Add=function(a){this.x+=a.x,this.y+=a.y},e.prototype.Subtract=function(a){this.x-=a.x,this.y-=a.y},e.prototype.Multiply=function(a){this.x*=a,this.y*=a},e.prototype.MulM=function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y,this.y=a.col1.y*b+a.col2.y*this.y},e.prototype.MulTM=function(a){var b=b2Math.Dot(this,a.col1);this.y=b2Math.Dot(this,a.col2),this.x=b},e.prototype.CrossVF=function(a){var b=this.x;this.x=a*this.y,this.y=-a*b},e.prototype.CrossFV=function(a){var b=this.x;this.x=-a*this.y,this.y=a*b},e.prototype.MinV=function(a){this.x=this.x<a.x?this.x:a.x,this.y=this.y<a.y?this.y:a.y},e.prototype.MaxV=function(a){this.x=this.x>a.x?this.x:a.x,this.y=this.y>a.y?this.y:a.y},e.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},e.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},e.prototype.Normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;return this.x*=b,this.y*=b,a},e.prototype.IsValid=function(){return b2Math.IsValid(this.x)&&b2Math.IsValid(this.y)},e.prototype.x=0,e.prototype.y=0,b.exports=e},2:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=b2Body.b2_staticBody,this.active=!0,this.inertiaScale=1},e.prototype.__varz=function(){this.position=new b2Vec2,this.linearVelocity=new b2Vec2},e.prototype.type=0,e.prototype.position=new b2Vec2,e.prototype.angle=null,e.prototype.linearVelocity=new b2Vec2,e.prototype.angularVelocity=null,e.prototype.linearDamping=null,e.prototype.angularDamping=null,e.prototype.allowSleep=null,e.prototype.awake=null,e.prototype.fixedRotation=null,e.prototype.bullet=null,e.prototype.active=null,e.prototype.userData=null,e.prototype.inertiaScale=null,b.exports=e},3:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(a,b){this.m_flags=0,a.bullet&&(this.m_flags|=e.e_bulletFlag),a.fixedRotation&&(this.m_flags|=e.e_fixedRotationFlag),a.allowSleep&&(this.m_flags|=e.e_allowSleepFlag),a.awake&&(this.m_flags|=e.e_awakeFlag),a.active&&(this.m_flags|=e.e_activeFlag),this.m_world=b,this.m_xf.position.SetV(a.position),this.m_xf.R.Set(a.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y,this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(a.linearVelocity),this.m_angularVelocity=a.angularVelocity,this.m_linearDamping=a.linearDamping,this.m_angularDamping=a.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=a.type,this.m_type==e.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=a.inertiaScale,this.m_userData=a.userData,this.m_fixtureList=null,this.m_fixtureCount=0},e.prototype.__varz=function(){this.m_xf=new b2Transform,this.m_sweep=new b2Sweep,this.m_linearVelocity=new b2Vec2,this.m_force=new b2Vec2},e.b2_staticBody=0,e.b2_kinematicBody=1,e.b2_dynamicBody=2,e.s_xf1=new b2Transform,e.e_islandFlag=1,e.e_awakeFlag=2,e.e_allowSleepFlag=4,e.e_bulletFlag=8,e.e_fixedRotationFlag=16,e.e_activeFlag=32,e.prototype.connectEdges=function(a,b,c){var d=Math.atan2(b.GetDirectionVector().y,b.GetDirectionVector().x),e=Math.tan((d-c)*.5),f=b2Math.MulFV(e,b.GetDirectionVector());f=b2Math.SubtractVV(f,b.GetNormalVector()),f=b2Math.MulFV(b2Settings.b2_toiSlop,f),f=b2Math.AddVV(f,b.GetVertex1());var g=b2Math.AddVV(a.GetDirectionVector(),b.GetDirectionVector());g.Normalize();var h=b2Math.Dot(a.GetDirectionVector(),b.GetNormalVector())>0;return a.SetNextEdge(b,f,g,h),b.SetPrevEdge(a,f,g,h),d},e.prototype.SynchronizeFixtures=function(){var a=e.s_xf1;a.R.Set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y),a.position.y=this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);var d,f=this.m_world.m_contactManager.m_broadPhase;for(d=this.m_fixtureList;d;d=d.m_next)d.Synchronize(f,a,this.m_xf)},e.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y),this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)},e.prototype.ShouldCollide=function(a){if(this.m_type!=e.b2_dynamicBody&&a.m_type!=e.b2_dynamicBody)return!1;for(var b=this.m_jointList;b;b=b.next)if(b.other==a&&b.joint.m_collideConnected==0)return!1;return!0},e.prototype.Advance=function(a){this.m_sweep.Advance(a),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},e.prototype.CreateFixture=function(a){if(this.m_world.IsLocked()==1)return null;var b=new b2Fixture;b.Create(this,this.m_xf,a);if(this.m_flags&e.e_activeFlag){var c=this.m_world.m_contactManager.m_broadPhase;b.CreateProxy(c,this.m_xf)}return b.m_next=this.m_fixtureList,this.m_fixtureList=b,++this.m_fixtureCount,b.m_body=this,b.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=b2World.e_newFixture,b},e.prototype.CreateFixture2=function(a,b){var c=new b2FixtureDef;return c.shape=a,c.density=b,this.CreateFixture(c)},e.prototype.DestroyFixture=function(a){if(this.m_world.IsLocked()==1)return;var b=this.m_fixtureList,c=null,d=!1;while(b!=null){if(b==a){c?c.m_next=a.m_next:this.m_fixtureList=a.m_next,d=!0;break}c=b,b=b.m_next}var f=this.m_contactList;while(f){var g=f.contact;f=f.next;var h=g.GetFixtureA(),i=g.GetFixtureB();(a==h||a==i)&&this.m_world.m_contactManager.Destroy(g)}if(this.m_flags&e.e_activeFlag){var j=this.m_world.m_contactManager.m_broadPhase;a.DestroyProxy(j)}a.Destroy(),a.m_body=null,a.m_next=null,--this.m_fixtureCount,this.ResetMassData()},e.prototype.SetPositionAndAngle=function(a,b){var c;if(this.m_world.IsLocked()==1)return;this.m_xf.R.Set(b),this.m_xf.position.SetV(a);var d=this.m_xf.R,e=this.m_sweep.localCenter;this.m_sweep.c.x=d.col1.x*e.x+d.col2.x*e.y,this.m_sweep.c.y=d.col1.y*e.x+d.col2.y*e.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=b;var f=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(f,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()},e.prototype.SetTransform=function(a){this.SetPositionAndAngle(a.position,a.GetAngle())},e.prototype.GetTransform=function(){return this.m_xf},e.prototype.GetPosition=function(){return this.m_xf.position},e.prototype.SetPosition=function(a){this.SetPositionAndAngle(a,this.GetAngle())},e.prototype.GetAngle=function(){return this.m_sweep.a},e.prototype.SetAngle=function(a){this.SetPositionAndAngle(this.GetPosition(),a)},e.prototype.GetWorldCenter=function(){return this.m_sweep.c},e.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},e.prototype.SetLinearVelocity=function(a){if(this.m_type==e.b2_staticBody)return;this.m_linearVelocity.SetV(a)},e.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},e.prototype.SetAngularVelocity=function(a){if(this.m_type==e.b2_staticBody)return;this.m_angularVelocity=a},e.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},e.prototype.GetDefinition=function(){var a=new b2BodyDef;return a.type=this.GetType(),a.allowSleep=(this.m_flags&e.e_allowSleepFlag)==e.e_allowSleepFlag,a.angle=this.GetAngle(),a.angularDamping=this.m_angularDamping,a.angularVelocity=this.m_angularVelocity,a.fixedRotation=(this.m_flags&e.e_fixedRotationFlag)==e.e_fixedRotationFlag,a.bullet=(this.m_flags&e.e_bulletFlag)==e.e_bulletFlag,a.awake=(this.m_flags&e.e_awakeFlag)==e.e_awakeFlag,a.linearDamping=this.m_linearDamping,a.linearVelocity.SetV(this.GetLinearVelocity()),a.position=this.GetPosition(),a.userData=this.GetUserData(),a},e.prototype.ApplyForce=function(a,b){if(this.m_type!=e.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x},e.prototype.ApplyTorque=function(a){if(this.m_type!=e.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_torque+=a},e.prototype.ApplyImpulse=function(a,b){if(this.m_type!=e.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)},e.prototype.Split=function(a){var b=this.GetLinearVelocity().Copy(),c=this.GetAngularVelocity(),d=this.GetWorldCenter(),e=this,f=this.m_world.CreateBody(this.GetDefinition()),g;for(var h=e.m_fixtureList;h;)if(a(h)){var i=h.m_next;g?g.m_next=i:e.m_fixtureList=i,e.m_fixtureCount--,h.m_next=f.m_fixtureList,f.m_fixtureList=h,f.m_fixtureCount++,h.m_body=f,h=i}else g=h,h=h.m_next;e.ResetMassData(),f.ResetMassData();var j=e.GetWorldCenter(),k=f.GetWorldCenter(),l=b2Math.AddVV(b,b2Math.CrossFV(c,b2Math.SubtractVV(j,d))),m=b2Math.AddVV(b,b2Math.CrossFV(c,b2Math.SubtractVV(k,d)));return e.SetLinearVelocity(l),f.SetLinearVelocity(m),e.SetAngularVelocity(c),f.SetAngularVelocity(c),e.SynchronizeFixtures(),f.SynchronizeFixtures(),f},e.prototype.Merge=function(a){var b;for(b=a.m_fixtureList;b;){var c=b.m_next;a.m_fixtureCount--,b.m_next=this.m_fixtureList,this.m_fixtureList=b,this.m_fixtureCount++,b.m_body=e,b=c}d.m_fixtureCount=0;var d=this,e=a,f=d.GetWorldCenter(),g=e.GetWorldCenter(),h=d.GetLinearVelocity().Copy(),i=e.GetLinearVelocity().Copy(),j=d.GetAngularVelocity(),k=e.GetAngularVelocity();d.ResetMassData(),this.SynchronizeFixtures()},e.prototype.GetMass=function(){return this.m_mass},e.prototype.GetInertia=function(){return this.m_I},e.prototype.GetMassData=function(a){a.mass=this.m_mass,a.I=this.m_I,a.center.SetV(this.m_sweep.localCenter)},e.prototype.SetMassData=function(a){b2Settings.b2Assert(this.m_world.IsLocked()==0);if(this.m_world.IsLocked()==1)return;if(this.m_type!=e.b2_dynamicBody)return;this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=a.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,a.I>0&&(this.m_flags&e.e_fixedRotationFlag)==0&&(this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var b=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a.center),this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-b.x)},e.prototype.ResetMassData=function(){this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero();if(this.m_type==e.b2_staticBody||this.m_type==e.b2_kinematicBody)return;var a=b2Vec2.Make(0,0);for(var b=this.m_fixtureList;b;b=b.m_next){if(b.m_density==0)continue;var c=b.GetMassData();this.m_mass+=c.mass,a.x+=c.center.x*c.mass,a.y+=c.center.y*c.mass,this.m_I+=c.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&(this.m_flags&e.e_fixedRotationFlag)==0?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,b2Settings.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var d=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a),this.m_sweep.c0.SetV(b2Math.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-d.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-d.x)},e.prototype.GetWorldPoint=function(a){var b=this.m_xf.R,c=new b2Vec2(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);return c.x+=this.m_xf.position.x,c.y+=this.m_xf.position.y,c},e.prototype.GetWorldVector=function(a){return b2Math.MulMV(this.m_xf.R,a)},e.prototype.GetLocalPoint=function(a){return b2Math.MulXT(this.m_xf,a)},e.prototype.GetLocalVector=function(a){return b2Math.MulTMV(this.m_xf.R,a)},e.prototype.GetLinearVelocityFromWorldPoint=function(a){return new b2Vec2(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},e.prototype.GetLinearVelocityFromLocalPoint=function(a){var b=this.m_xf.R,c=new b2Vec2(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);return c.x+=this.m_xf.position.x,c.y+=this.m_xf.position.y,new b2Vec2(this.m_linearVelocity.x-this.m_angularVelocity*(c.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(c.x-this.m_sweep.c.x))},e.prototype.GetLinearDamping=function(){return this.m_linearDamping},e.prototype.SetLinearDamping=function(a){this.m_linearDamping=a},e.prototype.GetAngularDamping=function(){return this.m_angularDamping},e.prototype.SetAngularDamping=function(a){this.m_angularDamping=a},e.prototype.SetType=function(a){if(this.m_type==a)return;this.m_type=a,this.ResetMassData(),this.m_type==e.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var b=this.m_contactList;b;b=b.next)b.contact.FlagForFiltering()},e.prototype.GetType=function(){return this.m_type},e.prototype.SetBullet=function(a){a?this.m_flags|=e.e_bulletFlag:this.m_flags&=~e.e_bulletFlag},e.prototype.IsBullet=function(){return(this.m_flags&e.e_bulletFlag)==e.e_bulletFlag},e.prototype.SetSleepingAllowed=function(a){a?this.m_flags|=e.e_allowSleepFlag:(this.m_flags&=~e.e_allowSleepFlag,this.SetAwake(!0))},e.prototype.SetAwake=function(a){a?(this.m_flags|=e.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~e.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},e.prototype.IsAwake=function(){return(this.m_flags&e.e_awakeFlag)==e.e_awakeFlag},e.prototype.SetFixedRotation=function(a){a?this.m_flags|=e.e_fixedRotationFlag:this.m_flags&=~e.e_fixedRotationFlag,this.ResetMassData()},e.prototype.IsFixedRotation=function(){return(this.m_flags&e.e_fixedRotationFlag)==e.e_fixedRotationFlag},e.prototype.SetActive=function(a){if(a==this.IsActive())return;var b,c;if(a){this.m_flags|=e.e_activeFlag,b=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.CreateProxy(b,this.m_xf)}else{this.m_flags&=~e.e_activeFlag,b=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.DestroyProxy(b);var d=this.m_contactList;while(d){var f=d;d=d.next,this.m_world.m_contactManager.Destroy(f.contact)}this.m_contactList=null}},e.prototype.IsActive=function(){return(this.m_flags&e.e_activeFlag)==e.e_activeFlag},e.prototype.IsSleepingAllowed=function(){return(this.m_flags&e.e_allowSleepFlag)==e.e_allowSleepFlag},e.prototype.GetFixtureList=function(){return this.m_fixtureList},e.prototype.GetJointList=function(){return this.m_jointList},e.prototype.GetControllerList=function(){return this.m_controllerList},e.prototype.GetContactList=function(){return this.m_contactList},e.prototype.GetNext=function(){return this.m_next},e.prototype.GetUserData=function(){return this.m_userData},e.prototype.SetUserData=function(a){this.m_userData=a},e.prototype.GetWorld=function(){return this.m_world},e.prototype.m_flags=0,e.prototype.m_type=0,e.prototype.m_islandIndex=0,e.prototype.m_xf=new b2Transform,e.prototype.m_sweep=new b2Sweep,e.prototype.m_linearVelocity=new b2Vec2,e.prototype.m_angularVelocity=null,e.prototype.m_force=new b2Vec2,e.prototype.m_torque=null,e.prototype.m_world=null,e.prototype.m_prev=null,e.prototype.m_next=null,e.prototype.m_fixtureList=null,e.prototype.m_fixtureCount=0,e.prototype.m_controllerList=null,e.prototype.m_controllerCount=0,e.prototype.m_jointList=null,e.prototype.m_contactList=null,e.prototype.m_mass=null,e.prototype.m_invMass=null,e.prototype.m_I=null,e.prototype.m_invI=null,e.prototype.m_inertiaScale=null,e.prototype.m_linearDamping=null,e.prototype.m_angularDamping=null,e.prototype.m_sleepTime=null,e.prototype.m_userData=null,b.exports=e},4:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},e.prototype.__varz=function(){this.filter=new b2FilterData},e.prototype.shape=null,e.prototype.userData=null,e.prototype.friction=null,e.prototype.restitution=null,e.prototype.density=null,e.prototype.isSensor=null,e.prototype.filter=new b2FilterData,b.exports=e},5:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){this.m_aabb=new b2AABB,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},e.prototype.__varz=function(){this.m_filter=new b2FilterData},e.prototype.Create=function(a,b,c){this.m_userData=c.userData,this.m_friction=c.friction,this.m_restitution=c.restitution,this.m_body=a,this.m_next=null,this.m_filter=c.filter.Copy(),this.m_isSensor=c.isSensor,this.m_shape=c.shape.Copy(),this.m_density=c.density},e.prototype.Destroy=function(){this.m_shape=null},e.prototype.CreateProxy=function(a,b){this.m_shape.ComputeAABB(this.m_aabb,b),this.m_proxy=a.CreateProxy(this.m_aabb,this)},e.prototype.DestroyProxy=function(a){if(this.m_proxy==null)return;a.DestroyProxy(this.m_proxy),this.m_proxy=null},e.prototype.Synchronize=function(a,b,c){if(!this.m_proxy)return;var d=new b2AABB,e=new b2AABB;this.m_shape.ComputeAABB(d,b),this.m_shape.ComputeAABB(e,c),this.m_aabb.Combine(d,e);var f=b2Math.SubtractVV(c.position,b.position);a.MoveProxy(this.m_proxy,this.m_aabb,f)},e.prototype.GetType=function(){return this.m_shape.GetType()},e.prototype.GetShape=function(){return this.m_shape},e.prototype.SetSensor=function(a){if(this.m_isSensor==a)return;this.m_isSensor=a;if(this.m_body==null)return;var b=this.m_body.GetContactList();while(b){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();(d==this||e==this)&&c.SetSensor(d.IsSensor()||e.IsSensor()),b=b.next}},e.prototype.IsSensor=function(){return this.m_isSensor},e.prototype.SetFilterData=function(a){this.m_filter=a.Copy();if(this.m_body)return;var b=this.m_body.GetContactList();while(b){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();(d==this||e==this)&&c.FlagForFiltering(),b=b.next}},e.prototype.GetFilterData=function(){return this.m_filter.Copy()},e.prototype.GetBody=function(){return this.m_body},e.prototype.GetNext=function(){return this.m_next},e.prototype.GetUserData=function(){return this.m_userData},e.prototype.SetUserData=function(a){this.m_userData=a},e.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)},e.prototype.RayCast=function(a,b){return this.m_shape.RayCast(a,b,this.m_body.GetTransform())},e.prototype.GetMassData=function(a){return a==null&&(a=new b2MassData),this.m_shape.ComputeMass(a,this.m_density),a},e.prototype.SetDensity=function(a){this.m_density=a},e.prototype.GetDensity=function(){return this.m_density},e.prototype.GetFriction=function(){return this.m_friction},e.prototype.SetFriction=function(a){this.m_friction=a},e.prototype.GetRestitution=function(){return this.m_restitution},e.prototype.SetRestitution=function(a){this.m_restitution=a},e.prototype.GetAABB=function(){return this.m_aabb},e.prototype.m_massData=null,e.prototype.m_aabb=null,e.prototype.m_density=null,e.prototype.m_next=null,e.prototype.m_body=null,e.prototype.m_shape=null,e.prototype.m_friction=null,e.prototype.m_restitution=null,e.prototype.m_proxy=null,e.prototype.m_filter=new b2FilterData,e.prototype.m_isSensor=null,e.prototype.m_userData=null,b.exports=e},6:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(a,b){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,e.m_warmStarting=!0,e.m_continuousPhysics=!0,this.m_allowSleep=b,this.m_gravity=a,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var c=new b2BodyDef;this.m_groundBody=this.CreateBody(c)},e.prototype.__varz=function(){this.s_stack=new Array,this.m_contactManager=new b2ContactManager,this.m_contactSolver=new b2ContactSolver,this.m_island=new b2Island},e.s_timestep2=new b2TimeStep,e.s_backupA=new b2Sweep,e.s_backupB=new b2Sweep,e.s_timestep=new b2TimeStep,e.s_queue=new Array,e.e_newFixture=1,e.e_locked=2,e.s_xf=new b2Transform,e.s_jointColor=new b2Color(.5,.8,.8),e.m_warmStarting=null,e.m_continuousPhysics=null,e.prototype.Solve=function(a){var b;for(var c=this.m_controllerList;c;c=c.m_next)c.Step(a);var d=this.m_island;d.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~b2Body.e_islandFlag;for(var e=this.m_contactList;e;e=e.m_next)e.m_flags&=~b2Contact.e_islandFlag;for(var f=this.m_jointList;f;f=f.m_next)f.m_islandFlag=!1;var g=this.m_bodyCount,h=this.s_stack;for(var i=this.m_bodyList;i;i=i.m_next){if(i.m_flags&b2Body.e_islandFlag)continue;if(i.IsAwake()==0||i.IsActive()==0)continue;if(i.GetType()==b2Body.b2_staticBody)continue;d.Clear();var j=0;h[j++]=i,i.m_flags|=b2Body.e_islandFlag;while(j>0){b=h[--j],d.AddBody(b),b.IsAwake()==0&&b.SetAwake(!0);if(b.GetType()==b2Body.b2_staticBody)continue;var k;for(var l=b.m_contactList;l;l=l.next){if(l.contact.m_flags&b2Contact.e_islandFlag)continue;if(l.contact.IsSensor()==1||l.contact.IsEnabled()==0||l.contact.IsTouching()==0)continue;d.AddContact(l.contact),l.contact.m_flags|=b2Contact.e_islandFlag,k=l.other;if(k.m_flags&b2Body.e_islandFlag)continue;h[j++]=k,k.m_flags|=b2Body.e_islandFlag}for(var m=b.m_jointList;m;m=m.next){if(m.joint.m_islandFlag==1)continue;k=m.other;if(k.IsActive()==0)continue;d.AddJoint(m.joint),m.joint.m_islandFlag=!0;if(k.m_flags&b2Body.e_islandFlag)continue;h[j++]=k,k.m_flags|=b2Body.e_islandFlag}}d.Solve(a,this.m_gravity,this.m_allowSleep);for(var n=0;n<d.m_bodyCount;++n)b=d.m_bodies[n],b.GetType()==b2Body.b2_staticBody&&(b.m_flags&=~b2Body.e_islandFlag)}for(n=0;n<h.length;++n){if(!h[n])break;h[n]=null}for(b=this.m_bodyList;b;b=b.m_next){if(b.IsAwake()==0||b.IsActive()==0)continue;if(b.GetType()==b2Body.b2_staticBody)continue;b.SynchronizeFixtures()}this.m_contactManager.FindNewContacts()},e.prototype.SolveTOI=function(a){var b,c,d,f,g,h,i,j=this.m_island;j.Initialize(this.m_bodyCount,b2Settings.b2_maxTOIContactsPerIsland,b2Settings.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var k=e.s_queue;for(b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~b2Body.e_islandFlag,b.m_sweep.t0=0;var l;for(l=this.m_contactList;l;l=l.m_next)l.m_flags&=~(b2Contact.e_toiFlag|b2Contact.e_islandFlag);for(i=this.m_jointList;i;i=i.m_next)i.m_islandFlag=!1;for(;;){var m=null,n=1;for(l=this.m_contactList;l;l=l.m_next){if(l.IsSensor()==1||l.IsEnabled()==0||l.IsContinuous()==0)continue;var o=1;if(l.m_flags&b2Contact.e_toiFlag)o=l.m_toi;else{c=l.m_fixtureA,d=l.m_fixtureB,f=c.m_body,g=d.m_body;if(!(f.GetType()==b2Body.b2_dynamicBody&&f.IsAwake()!=0||g.GetType()==b2Body.b2_dynamicBody&&g.IsAwake()!=0))continue;var p=f.m_sweep.t0;f.m_sweep.t0<g.m_sweep.t0?(p=g.m_sweep.t0,f.m_sweep.Advance(p)):g.m_sweep.t0<f.m_sweep.t0&&(p=f.m_sweep.t0,g.m_sweep.Advance(p)),o=l.ComputeTOI(f.m_sweep,g.m_sweep),b2Settings.b2Assert(0<=o&&o<=1),o>0&&o<1&&(o=(1-o)*p+o,o>1&&(o=1)),l.m_toi=o,l.m_flags|=b2Contact.e_toiFlag}Number.MIN_VALUE<o&&o<n&&(m=l,n=o)}if(m==null||1-100*Number.MIN_VALUE<n)break;c=m.m_fixtureA,d=m.m_fixtureB,f=c.m_body,g=d.m_body,e.s_backupA.Set(f.m_sweep),e.s_backupB.Set(g.m_sweep),f.Advance(n),g.Advance(n),m.Update(this.m_contactManager.m_contactListener),m.m_flags&=~b2Contact.e_toiFlag;if(m.IsSensor()==1||m.IsEnabled()==0){f.m_sweep.Set(e.s_backupA),g.m_sweep.Set(e.s_backupB),f.SynchronizeTransform(),g.SynchronizeTransform();continue}if(m.IsTouching()==0)continue;var q=f;q.GetType()!=b2Body.b2_dynamicBody&&(q=g),j.Clear();var r=0,s=0;k[r+s++]=q,q.m_flags|=b2Body.e_islandFlag;while(s>0){b=k[r++],--s,j.AddBody(b),b.IsAwake()==0&&b.SetAwake(!0);if(b.GetType()!=b2Body.b2_dynamicBody)continue;for(h=b.m_contactList;h;h=h.next){if(j.m_contactCount==j.m_contactCapacity)break;if(h.contact.m_flags&b2Contact.e_islandFlag)continue;if(h.contact.IsSensor()==1||h.contact.IsEnabled()==0||h.contact.IsTouching()==0)continue;j.AddContact(h.contact),h.contact.m_flags|=b2Contact.e_islandFlag;var t=h.other;if(t.m_flags&b2Body.e_islandFlag)continue;t.GetType()!=b2Body.b2_staticBody&&(t.Advance(n),t.SetAwake(!0)),k[r+s]=t,++s,t.m_flags|=b2Body.e_islandFlag}for(var u=b.m_jointList;u;u=u.next){if(j.m_jointCount==j.m_jointCapacity)continue;if(u.joint.m_islandFlag==1)continue;t=u.other;if(t.IsActive()==0)continue;j.AddJoint(u.joint),u.joint.m_islandFlag=!0;if(t.m_flags&b2Body.e_islandFlag)continue;t.GetType()!=b2Body.b2_staticBody&&(t.Advance(n),t.SetAwake(!0)),k[r+s]=t,++s,t.m_flags|=b2Body.e_islandFlag}}var v=e.s_timestep;v.warmStarting=!1,v.dt=(1-n)*a.dt,v.inv_dt=1/v.dt,v.dtRatio=0,v.velocityIterations=a.velocityIterations,v.positionIterations=a.positionIterations,j.SolveTOI(v);var w=0;for(w=0;w<j.m_bodyCount;++w){b=j.m_bodies[w],b.m_flags&=~b2Body.e_islandFlag;if(b.IsAwake()==0)continue;if(b.GetType()!=b2Body.b2_dynamicBody)continue;b.SynchronizeFixtures();for(h=b.m_contactList;h;h=h.next)h.contact.m_flags&=~b2Contact.e_toiFlag}for(w=0;w<j.m_contactCount;++w)l=j.m_contacts[w],l.m_flags&=~(b2Contact.e_toiFlag|b2Contact.e_islandFlag);for(w=0;w<j.m_jointCount;++w)i=j.m_joints[w],i.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}},e.prototype.DrawJoint=function(a){var b=a.GetBodyA(),c=a.GetBodyB(),d=b.m_xf,f=c.m_xf,g=d.position,h=f.position,i=a.GetAnchorA(),j=a.GetAnchorB(),k=e.s_jointColor;switch(a.m_type){case b2Joint.e_distanceJoint:this.m_debugDraw.DrawSegment(i,j,k);break;case b2Joint.e_pulleyJoint:var l=a,m=l.GetGroundAnchorA(),n=l.GetGroundAnchorB();this.m_debugDraw.DrawSegment(m,i,k),this.m_debugDraw.DrawSegment(n,j,k),this.m_debugDraw.DrawSegment(m,n,k);break;case b2Joint.e_mouseJoint:this.m_debugDraw.DrawSegment(i,j,k);break;default:b!=this.m_groundBody&&this.m_debugDraw.DrawSegment(g,i,k),this.m_debugDraw.DrawSegment(i,j,k),c!=this.m_groundBody&&this.m_debugDraw.DrawSegment(h,j,k)}},e.prototype.DrawShape=function(a,b,c){switch(a.m_type){case b2Shape.e_circleShape:var d=a,e=b2Math.MulX(b,d.m_p),f=d.m_radius,g=b.R.col1;this.m_debugDraw.DrawSolidCircle(e,f,g,c);break;case b2Shape.e_polygonShape:var h=0,i=a,j=i.GetVertexCount(),k=i.GetVertices(),l=new Array(j);for(h=0;h<j;++h)l[h]=b2Math.MulX(b,k[h]);this.m_debugDraw.DrawSolidPolygon(l,j,c);break;case b2Shape.e_edgeShape:var m=a;this.m_debugDraw.DrawSegment(b2Math.MulX(b,m.GetVertex1()),b2Math.MulX(b,m.GetVertex2()),c)}},e.prototype.SetDestructionListener=function(a){this.m_destructionListener=a},e.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a},e.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a},e.prototype.SetDebugDraw=function(a){this.m_debugDraw=a},e.prototype.SetBroadPhase=function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;c;c=c.m_next)for(var d=c.m_fixtureList;d;d=d.m_next)d.m_proxy=a.CreateProxy(b.GetFatAABB(d.m_proxy),d)},e.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},e.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},e.prototype.CreateBody=function(a){if(this.IsLocked()==1)return null;var b=new b2Body(a,this);return b.m_prev=null,b.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=b),this.m_bodyList=b,++this.m_bodyCount,b},e.prototype.DestroyBody=function(a){if(this.IsLocked()==1)return;var b=a.m_jointList;while(b){var c=b;b=b.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(c.joint),this.DestroyJoint(c.joint)}var d=a.m_controllerList;while(d){var e=d;d=d.nextController,e.controller.RemoveBody(a)}var f=a.m_contactList;while(f){var g=f;f=f.next,this.m_contactManager.Destroy(g.contact)}a.m_contactList=null;var h=a.m_fixtureList;while(h){var i=h;h=h.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(i),i.DestroyProxy(this.m_contactManager.m_broadPhase),i.Destroy()}a.m_fixtureList=null,a.m_fixtureCount=0,a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_bodyList&&(this.m_bodyList=a.m_next),--this.m_bodyCount},e.prototype.CreateJoint=function(a){var b=b2Joint.Create(a,null);b.m_prev=null,b.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=b),this.m_jointList=b,++this.m_jointCount,b.m_edgeA.joint=b,b.m_edgeA.other=b.m_bodyB,b.m_edgeA.prev=null,b.m_edgeA.next=b.m_bodyA.m_jointList,b.m_bodyA.m_jointList&&(b.m_bodyA.m_jointList.prev=b.m_edgeA),b.m_bodyA.m_jointList=b.m_edgeA,b.m_edgeB.joint=b,b.m_edgeB.other=b.m_bodyA,b.m_edgeB.prev=null,b.m_edgeB.next=b.m_bodyB.m_jointList,b.m_bodyB.m_jointList&&(b.m_bodyB.m_jointList.prev=b.m_edgeB),b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(a.collideConnected==0){var e=d.GetContactList();while(e)e.other==c&&e.contact.FlagForFiltering(),e=e.next}return b},e.prototype.DestroyJoint=function(a){var b=a.m_collideConnected;a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;c.SetAwake(!0),d.SetAwake(!0),a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next),a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev),a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next),a.m_edgeA.prev=null,a.m_edgeA.next=null,a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next),a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev),a.m_edgeB==d.m_jointList&&(d.m_jointList=a.m_edgeB.next),a.m_edgeB.prev=null,a.m_edgeB.next=null,b2Joint.Destroy(a,null),--this.m_jointCount;if(b==0){var e=d.GetContactList();while(e)e.other==c&&e.contact.FlagForFiltering(),e=e.next}},e.prototype.AddController=function(a){return a.m_next=this.m_controllerList,a.m_prev=null,this.m_controllerList=a,a.m_world=this,this.m_controllerCount++,a},e.prototype.RemoveController=function(a){a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),this.m_controllerList==a&&(this.m_controllerList=a.m_next),this.m_controllerCount--},e.prototype.CreateController=function(a){if(a.m_world!=this)throw new Error("Controller can only be a member of one world");return a.m_next=this.m_controllerList,a.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=a),this.m_controllerList=a,++this.m_controllerCount,a.m_world=this,a},e.prototype.DestroyController=function(a){a.Clear(),a.m_next&&(a.m_next.m_prev=a.m_prev),a.m_prev&&(a.m_prev.m_next=a.m_next),a==this.m_controllerList&&(this.m_controllerList=a.m_next),--this.m_controllerCount},e.prototype.SetWarmStarting=function(a){e.m_warmStarting=a},e.prototype.SetContinuousPhysics=function(a){e.m_continuousPhysics=a},e.prototype.GetBodyCount=function(){return this.m_bodyCount},e.prototype.GetJointCount=function(){return this.m_jointCount},e.prototype.GetContactCount=function(){return this.m_contactCount},e.prototype.SetGravity=function(a){this.m_gravity=a},e.prototype.GetGravity=function(){return this.m_gravity},e.prototype.GetGroundBody=function(){return this.m_groundBody},e.prototype.Step=function(a,b,c){this.m_flags&e.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~e.e_newFixture),this.m_flags|=e.e_locked;var d=e.s_timestep2;d.dt=a,d.velocityIterations=b,d.positionIterations=c,a>0?d.inv_dt=1/a:d.inv_dt=0,d.dtRatio=this.m_inv_dt0*a,d.warmStarting=e.m_warmStarting,this.m_contactManager.Collide(),d.dt>0&&this.Solve(d),e.m_continuousPhysics&&d.dt>0&&this.SolveTOI(d),d.dt>0&&(this.m_inv_dt0=d.inv_dt),this.m_flags&=~e.e_locked},e.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0},e.prototype.DrawDebugData=function(){if(this.m_debugDraw==null)return;this.m_debugDraw.Clear();var a=this.m_debugDraw.GetFlags(),b=0,c,d,f,g,h,i=new b2Vec2,j=new b2Vec2,k=new b2Vec2,l,m=new b2AABB,n=new b2AABB,o=[new b2Vec2,new b2Vec2,new b2Vec2,new b2Vec2],p=new b2Color(0,0,0);if(a&b2DebugDraw.e_shapeBit)for(c=this.m_bodyList;c;c=c.m_next){l=c.m_xf;for(d=c.GetFixtureList();d;d=d.m_next)f=d.GetShape(),c.IsActive()==0?(p.Set(.5,.5,.3),this.DrawShape(f,l,p)):c.GetType()==b2Body.b2_staticBody?(p.Set(.5,.9,.5),this.DrawShape(f,l,p)):c.GetType()==b2Body.b2_kinematicBody?(p.Set(.5,.5,.9),this.DrawShape(f,l,p)):c.IsAwake()==0?(p.Set(.6,.6,.6),this.DrawShape(f,l,p)):(p.Set(.9,.7,.7),this.DrawShape(f,l,p))}if(a&b2DebugDraw.e_jointBit)for(g=this.m_jointList;g;g=g.m_next)this.DrawJoint(g);if(a&b2DebugDraw.e_controllerBit)for(var q=this.m_controllerList;q;q=q.m_next)q.Draw(this.m_debugDraw);if(a&b2DebugDraw.e_pairBit){p.Set(.3,.9,.9);for(var r=this.m_contactManager.m_contactList;r;r=r.GetNext()){var s=r.GetFixtureA(),t=r.GetFixtureB(),u=s.GetAABB().GetCenter(),v=t.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(u,v,p)}}if(a&b2DebugDraw.e_aabbBit){h=this.m_contactManager.m_broadPhase,o=[new b2Vec2,new b2Vec2,new b2Vec2,new b2Vec2];for(c=this.m_bodyList;c;c=c.GetNext()){if(c.IsActive()==0)continue;for(d=c.GetFixtureList();d;d=d.GetNext()){var w=h.GetFatAABB(d.m_proxy);o[0].Set(w.lowerBound.x,w.lowerBound.y),o[1].Set(w.upperBound.x,w.lowerBound.y),o[2].Set(w.upperBound.x,w.upperBound.y),o[3].Set(w.lowerBound.x,w.upperBound.y),this.m_debugDraw.DrawPolygon(o,4,p)}}}if(a&b2DebugDraw.e_centerOfMassBit)for(c=this.m_bodyList;c;c=c.m_next)l=e.s_xf,l.R=c.m_xf.R,l.position=c.GetWorldCenter(),this.m_debugDraw.DrawTransform(l)},e.prototype.QueryAABB=function(a,b){function d(b){return a(c.GetUserData(b))}var c=this.m_contactManager.m_broadPhase;c.Query(d,b)},e.prototype.QueryShape=function(a,b,c){function e(e){var f=d.GetUserData(e);return b2Shape.TestOverlap(b,c,f.GetShape(),f.GetBody().GetTransform())?a(f):!0}c==null&&(c=new b2Transform,c.SetIdentity());var d=this.m_contactManager.m_broadPhase,f=new b2AABB;b.ComputeAABB(f,c),d.Query(e,f)},e.prototype.QueryPoint=function(a,b){function d(d){var e=c.GetUserData(d);return e.TestPoint(b)?a(e):!0}var c=this.m_contactManager.m_broadPhase,e=new b2AABB;e.lowerBound.Set(b.x-b2Settings.b2_linearSlop,b.y-b2Settings.b2_linearSlop),e.upperBound.Set(b.x+b2Settings.b2_linearSlop,b.y+b2Settings.b2_linearSlop),c.Query(d,e)},e.prototype.RayCast=function(a,b,c){function f(f,g){var h=d.GetUserData(g),i=h,j=i.RayCast(e,f);if(j){var k=e.fraction,l=new b2Vec2((1-k)*b.x+k*c.x,(1-k)*b.y+k*c.y);return a(i,l,e.normal,k)}return f.maxFraction}var d=this.m_contactManager.m_broadPhase,e=new b2RayCastOutput,g=new b2RayCastInput(b,c);d.RayCast(f,g)},e.prototype.RayCastOne=function(a,b){function d(a,b,d,e){return c=a,e}var c;return this.RayCast(d,a,b),c},e.prototype.RayCastAll=function(a,b){function d(a,b,d,e){return c[c.length]=a,1}var c=new Array;return this.RayCast(d,a,b),c},e.prototype.GetBodyList=function(){return this.m_bodyList},e.prototype.GetJointList=function(){return this.m_jointList},e.prototype.GetContactList=function(){return this.m_contactList},e.prototype.IsLocked=function(){return(this.m_flags&e.e_locked)>0},e.prototype.s_stack=new Array,e.prototype.m_flags=0,e.prototype.m_contactManager=new b2ContactManager,e.prototype.m_contactSolver=new b2ContactSolver,e.prototype.m_island=new b2Island,e.prototype.m_bodyList=null,e.prototype.m_jointList=null,e.prototype.m_contactList=null,e.prototype.m_bodyCount=0,e.prototype.m_contactCount=0,e.prototype.m_jointCount=0,e.prototype.m_controllerList=null,e.prototype.m_controllerCount=0,e.prototype.m_gravity=null,e.prototype.m_allowSleep=null,e.prototype.m_groundBody=null,e.prototype.m_destructionListener=null,e.prototype.m_debugDraw=null,e.prototype.m_inv_dt0=null,b.exports=e},7:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){},e.prototype.__varz=function(){this.center=new b2Vec2(0,0)},e.prototype.mass=0,e.prototype.center=new b2Vec2(0,0),e.prototype.I=0,b.exports=e},8:function(a,b,c,d){var e=function(){b2Shape.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)};extend(e.prototype,b2Shape.prototype),e.prototype._super=b2Shape.prototype,e.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.m_type=b2Shape.e_polygonShape,this.m_centroid=new b2Vec2,this.m_vertices=new Array,this.m_normals=new Array},e.prototype.__varz=function(){},e.AsArray=function(a,b){var c=new e;return c.SetAsArray(a,b),c},e.AsVector=function(a,b){var c=new e;return c.SetAsVector(a,b),c},e.AsBox=function(a,b){var c=new e;return c.SetAsBox(a,b),c},e.AsOrientedBox=function(a,b,c,d){var f=new e;return f.SetAsOrientedBox(a,b,c,d),f},e.AsEdge=function(a,b){var c=new e;return c.SetAsEdge(a,b),c},e.ComputeCentroid=function(a,b){var c=new b2Vec2,d=0,e=0,f=0,g=1/3;for(var h=0;h<b;++h){var i=a[h],j=h+1<b?a[parseInt(h+1)]:a[0],k=i.x-e,l=i.y-f,m=j.x-e,n=j.y-f,o=k*n-l*m,p=.5*o;d+=p,c.x+=p*g*(e+i.x+j.x),c.y+=p*g*(f+i.y+j.y)}return c.x*=1/d,c.y*=1/d,c},e.ComputeOBB=function(a,b,c){var d=0,e=new Array(c+1);for(d=0;d<c;++d)e[d]=b[d];e[c]=e[0];var f=Number.MAX_VALUE;for(d=1;d<=c;++d){var g=e[parseInt(d-1)],h=e[d].x-g.x,i=e[d].y-g.y,j=Math.sqrt(h*h+i*i);h/=j,i/=j;var k=-i,l=h,m=Number.MAX_VALUE,n=Number.MAX_VALUE,o=-Number.MAX_VALUE,p=-Number.MAX_VALUE;for(var q=0;q<c;++q){var r=e[q].x-g.x,s=e[q].y-g.y,t=h*r+i*s,u=k*r+l*s;t<m&&(m=t),u<n&&(n=u),t>o&&(o=t),u>p&&(p=u)}var v=(o-m)*(p-n);if(v<.95*f){f=v,a.R.col1.x=h,a.R.col1.y=i,a.R.col2.x=k,a.R.col2.y=l;var w=.5*(m+o),x=.5*(n+p),y=a.R;a.center.x=g.x+(y.col1.x*w+y.col2.x*x),a.center.y=g.y+(y.col1.y*w+y.col2.y*x),a.extents.x=.5*(o-m),a.extents.y=.5*(p-n)}}},e.s_mat=new b2Mat22,e.prototype.Validate=function(){return!1},e.prototype.Reserve=function(a){for(var b=this.m_vertices.length;b<a;b++)this.m_vertices[b]=new b2Vec2,this.m_normals[b]=new b2Vec2},e.prototype.Copy=function(){var a=new e;return a.Set(this),a},e.prototype.Set=function(a){this._super.Set.apply(this,[a]);if(isInstanceOf(a,e)){var b=a;this.m_centroid.SetV(b.m_centroid),this.m_vertexCount=b.m_vertexCount,this.Reserve(this.m_vertexCount);for(var c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(b.m_vertices[c]),this.m_normals[c].SetV(b.m_normals[c])}},e.prototype.SetAsArray=function(a,b){var c=new Array;for(var d=0,e=null;d<a.length,e=a[d];d++)c.push(e);this.SetAsVector(c,b)},e.prototype.SetAsVector=function(a,b){typeof b=="undefined"&&(b=a.length),b2Settings.b2Assert(2<=b),this.m_vertexCount=b,this.Reserve(b);var c=0;for(c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(a[c]);for(c=0;c<this.m_vertexCount;++c){var d=c,f=c+1<this.m_vertexCount?c+1:0,g=b2Math.SubtractVV(this.m_vertices[f],this.m_vertices[d]);b2Settings.b2Assert(g.LengthSquared()>Number.MIN_VALUE),this.m_normals[c].SetV(b2Math.CrossVF(g,1)),this.m_normals[c].Normalize()}this.m_centroid=e.ComputeCentroid(this.m_vertices,this.m_vertexCount)},e.prototype.SetAsBox=function(a,b){this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-a,-b),this.m_vertices[1].Set(a,-b),this.m_vertices[2].Set(a,b),this.m_vertices[3].Set(-a,b),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},e.prototype.SetAsOrientedBox=function(a,b,c,d){this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-a,-b),this.m_vertices[1].Set(a,-b),this.m_vertices[2].Set(a,b),this.m_vertices[3].Set(-a,b),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=c;var e=new b2Transform;e.position=c,e.R.Set(d);for(var f=0;f<this.m_vertexCount;++f)this.m_vertices[f]=b2Math.MulX(e,this.m_vertices[f]),this.m_normals[f]=b2Math.MulMV(e.R,this.m_normals[f])},e.prototype.SetAsEdge=function(a,b){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(a),this.m_vertices[1].SetV(b),this.m_centroid.x=.5*(a.x+b.x),this.m_centroid.y=.5*(a.y+b.y),this.m_normals[0]=b2Math.CrossVF(b2Math.SubtractVV(b,a),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},e.prototype.TestPoint=function(a,b){var c,d=a.R,e=b.x-a.position.x,f=b.y-a.position.y,g=e*d.col1.x+f*d.col1.y,h=e*d.col2.x+f*d.col2.y;for(var i=0;i<this.m_vertexCount;++i){c=this.m_vertices[i],e=g-c.x,f=h-c.y,c=this.m_normals[i];var j=c.x*e+c.y*f;if(j>0)return!1}return!0},e.prototype.RayCast=function(a,b,c){var d=0,e=b.maxFraction,f,g,h,i;f=b.p1.x-c.position.x,g=b.p1.y-c.position.y,h=c.R;var j=f*h.col1.x+g*h.col1.y,k=f*h.col2.x+g*h.col2.y;f=b.p2.x-c.position.x,g=b.p2.y-c.position.y,h=c.R;var l=f*h.col1.x+g*h.col1.y,m=f*h.col2.x+g*h.col2.y,n=l-j,o=m-k,p=-1;for(var q=0;q<this.m_vertexCount;++q){i=this.m_vertices[q],f=i.x-j,g=i.y-k,i=this.m_normals[q];var r=i.x*f+i.y*g,s=i.x*n+i.y*o;if(s==0){if(r<0)return!1}else s<0&&r<d*s?(d=r/s,p=q):s>0&&r<e*s&&(e=r/s);if(e<d-Number.MIN_VALUE)return!1}return p>=0?(a.fraction=d,h=c.R,i=this.m_normals[p],a.normal.x=h.col1.x*i.x+h.col2.x*i.y,a.normal.y=h.col1.y*i.x+h.col2.y*i.y,!0):!1},e.prototype.ComputeAABB=function(a,b){var c=b.R,d=this.m_vertices[0],e=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),f=b.position.y+(c.col1.y*d.x+c.col2.y*d.y),g=e,h=f;for(var i=1;i<this.m_vertexCount;++i){d=this.m_vertices[i];var j=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),k=b.position.y+(c.col1.y*d.x+c.col2.y*d.y);e=e<j?e:j,f=f<k?f:k,g=g>j?g:j,h=h>k?h:k}a.lowerBound.x=e-this.m_radius,a.lowerBound.y=f-this.m_radius,a.upperBound.x=g+this.m_radius,a.upperBound.y=h+this.m_radius},e.prototype.ComputeMass=function(a,b){if(this.m_vertexCount==2){a.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),a.mass=0,a.I=0;return}var c=0,d=0,e=0,f=0,g=0,h=0,i=1/3;for(var j=0;j<this.m_vertexCount;++j){var k=this.m_vertices[j],l=j+1<this.m_vertexCount?this.m_vertices[parseInt(j+1)]:this.m_vertices[0],m=k.x-g,n=k.y-h,o=l.x-g,p=l.y-h,q=m*p-n*o,r=.5*q;e+=r,c+=r*i*(g+k.x+l.x),d+=r*i*(h+k.y+l.y);var s=g,t=h,u=m,v=n,w=o,x=p,y=i*(.25*(u*u+w*u+w*w)+(s*u+s*w))+.5*s*s,z=i*(.25*(v*v+x*v+x*x)+(t*v+t*x))+.5*t*t;f+=q*(y+z)}a.mass=b*e,c*=1/e,d*=1/e,a.center.Set(c,d),a.I=b*f},e.prototype.ComputeSubmergedArea=function(a,b,c,d){var e=b2Math.MulTMV(c.R,a),f=b-b2Math.Dot(a,c.position),g=new Array,h=0,i=-1,j=-1,k=!1,l=0;for(l=0;l<this.m_vertexCount;++l){g[l]=b2Math.Dot(e,this.m_vertices[l])-f;var m=g[l]<-Number.MIN_VALUE;l>0&&(m?k||(i=l-1,h++):k&&(j=l-1,h++)),k=m}switch(h){case 0:if(k){var n=new b2MassData;return this.ComputeMass(n,1),d.SetV(b2Math.MulX(c,n.center)),n.mass}return 0;case 1:i==-1?i=this.m_vertexCount-1:j=this.m_vertexCount-1}var o=(i+1)%this.m_vertexCount,p=(j+1)%this.m_vertexCount,q=(0-g[i])/(g[o]-g[i]),r=(0-g[j])/(g[p]-g[j]),s=new b2Vec2(this.m_vertices[i].x*(1-q)+this.m_vertices[o].x*q,this.m_vertices[i].y*(1-q)+this.m_vertices[o].y*q),t=new b2Vec2(this.m_vertices[j].x*(1-r)+this.m_vertices[p].x*r,this.m_vertices[j].y*(1-r)+this.m_vertices[p].y*r),u=0,v=new b2Vec2,w=this.m_vertices[o],x;l=o;while(l!=p){l=(l+1)%this.m_vertexCount,l==p?x=t:x=this.m_vertices[l];var y=.5*((w.x-s.x)*(x.y-s.y)-(w.y-s.y)*(x.x-s.x));u+=y,v.x+=y*(s.x+w.x+x.x)/3,v.y+=y*(s.y+w.y+x.y)/3,w=x}return v.Multiply(1/u),d.SetV(b2Math.MulX(c,v)),u},e.prototype.GetVertexCount=function(){return this.m_vertexCount},e.prototype.GetVertices=function(){return this.m_vertices},e.prototype.GetNormals=function(){return this.m_normals},e.prototype.GetSupport=function(a){var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y;for(var d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return b},e.prototype.GetSupportVertex=function(a){var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y;for(var d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return this.m_vertices[b]},e.prototype.m_centroid=null,e.prototype.m_vertices=null,e.prototype.m_normals=null,e.prototype.m_vertexCount=0,b.exports=e},9:function(a,b,c,d){var e=function(){b2Shape.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)};extend(e.prototype,b2Shape.prototype),e.prototype._super=b2Shape.prototype,e.prototype.__constructor=function(a){this._super.__constructor.apply(this,[]),this.m_type=b2Shape.e_circleShape,this.m_radius=a},e.prototype.__varz=function(){this.m_p=new b2Vec2},e.prototype.Copy=function(){var a=new e;return a.Set(this),a},e.prototype.Set=function(a){this._super.Set.apply(this,[a]);if(isInstanceOf(a,e)){var b=a;this.m_p.SetV(b.m_p)}},e.prototype.TestPoint=function(a,b){var c=a.R,d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),e=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);return d=b.x-d,e=b.y-e,d*d+e*e<=this.m_radius*this.m_radius},e.prototype.RayCast=function(a,b,c){var d=c.R,e=c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y),f=c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y),g=b.p1.x-e,h=b.p1.y-f,i=g*g+h*h-this.m_radius*this.m_radius,j=b.p2.x-b.p1.x,k=b.p2.y-b.p1.y,l=g*j+h*k,m=j*j+k*k,n=l*l-m*i;if(n<0||m<Number.MIN_VALUE)return!1;var o=-(l+Math.sqrt(n));return 0<=o&&o<=b.maxFraction*m?(o/=m,a.fraction=o,a.normal.x=g+o*j,a.normal.y=h+o*k,a.normal.Normalize(),!0):!1},e.prototype.ComputeAABB=function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),e=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.Set(d-this.m_radius,e-this.m_radius),a.upperBound.Set(d+this.m_radius,e+this.m_radius)},e.prototype.ComputeMass=function(a,b){a.mass=b*b2Settings.b2_pi*this.m_radius*this.m_radius,a.center.SetV(this.m_p),a.I=a.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},e.prototype.ComputeSubmergedArea=function(a,b,c,d){var e=b2Math.MulX(c,this.m_p),f=-(b2Math.Dot(a,e)-b);if(f<-this.m_radius+Number.MIN_VALUE)return 0;if(f>this.m_radius)return d.SetV(e),Math.PI*this.m_radius*this.m_radius;var g=this.m_radius*this.m_radius,h=f*f,i=g*(Math.asin(f/this.m_radius)+Math.PI/2)+f*Math.sqrt(g-h),j=-2/3*Math.pow(g-h,1.5)/i;return d.x=e.x+a.x*j,d.y=e.y+a.y*j,i},e.prototype.GetLocalPosition=function(){return this.m_p},e.prototype.SetLocalPosition=function(a){this.m_p.SetV(a)},e.prototype.GetRadius=function(){return this.m_radius},e.prototype.SetRadius=function(a){this.m_radius=a},e.prototype.m_p=new b2Vec2,b.exports=e},a:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){this.m_drawFlags=0},e.prototype.__varz=function(){},e.e_shapeBit=1,e.e_jointBit=2,e.e_aabbBit=4,e.e_pairBit=8,e.e_centerOfMassBit=16,e.e_controllerBit=32,e.prototype.SetFlags=function(a){this.m_drawFlags=a},e.prototype.GetFlags=function(){return this.m_drawFlags},e.prototype.AppendFlags=function(a){this.m_drawFlags|=a},e.prototype.ClearFlags=function(a){this.m_drawFlags&=~a},e.prototype.SetSprite=function(a){this.m_sprite=a},e.prototype.GetSprite=function(){return this.m_sprite},e.prototype.SetDrawScale=function(a){this.m_drawScale=a},e.prototype.GetDrawScale=function(){return this.m_drawScale},e.prototype.SetLineThickness=function(a){this.m_lineThickness=a},e.prototype.GetLineThickness=function(){return this.m_lineThickness},e.prototype.SetAlpha=function(a){this.m_alpha=a},e.prototype.GetAlpha=function(){return this.m_alpha},e.prototype.SetFillAlpha=function(a){this.m_fillAlpha=a},e.prototype.GetFillAlpha=function(){return this.m_fillAlpha},e.prototype.SetXFormScale=function(a){this.m_xformScale=a},e.prototype.GetXFormScale=function(){return this.m_xformScale},e.prototype.Clear=function(){this.m_sprite.clearRect(0,0,this.m_sprite.canvas.width,this.m_sprite.canvas.height)},e.prototype.Y=function(a){return this.m_sprite.canvas.height-a},e.prototype.ToWorldPoint=function(a){return new b2Vec2(a.x/this.m_drawScale,this.Y(a.y)/this.m_drawScale)},e.prototype.ColorStyle=function(a,b){return"rgba("+a.r+", "+a.g+", "+a.b+", "+b+")"},e.prototype.DrawPolygon=function(a,b,c){this.m_sprite.graphics.lineStyle(this.m_lineThickness,c.color,this.m_alpha),this.m_sprite.graphics.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);for(var d=1;d<b;d++)this.m_sprite.graphics.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale);this.m_sprite.graphics.lineTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale)},e.prototype.DrawSolidPolygon=function(a,b,c){this.m_sprite.strokeSyle=this.ColorStyle(c,this.m_alpha),this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.fillStyle=this.ColorStyle(c,this.m_fillAlpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a[0].x*this.m_drawScale,this.Y(a[0].y*this.m_drawScale));for(var d=1;d<b;d++)this.m_sprite.lineTo(a[d].x*this.m_drawScale,this.Y(a[d].y*this.m_drawScale));this.m_sprite.lineTo(a[0].x*this.m_drawScale,this.Y(a[0].y*this.m_drawScale)),this.m_sprite.fill(),this.m_sprite.stroke(),this.m_sprite.closePath()},e.prototype.DrawCircle=function(a,b,c){this.m_sprite.graphics.lineStyle(this.m_lineThickness,c.color,this.m_alpha),this.m_sprite.graphics.drawCircle(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale)},e.prototype.DrawSolidCircle=function(a,b,c,d){this.m_sprite.strokeSyle=this.ColorStyle(d,this.m_alpha),this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.fillStyle=this.ColorStyle(d,this.m_fillAlpha),this.m_sprite.beginPath(),this.m_sprite.arc(a.x*this.m_drawScale,this.Y(a.y*this.m_drawScale),b*this.m_drawScale,0,Math.PI*2,!0),this.m_sprite.fill(),this.m_sprite.stroke(),this.m_sprite.closePath()},e.prototype.DrawSegment=function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.strokeSyle=this.ColorStyle(c,this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.x*this.m_drawScale,this.Y(a.y*this.m_drawScale)),this.m_sprite.lineTo(b.x*this.m_drawScale,this.Y(b.y*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath()},e.prototype.DrawTransform=function(a){this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.strokeSyle=this.ColorStyle(new b2Color(255,0,0),this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.position.x*this.m_drawScale,this.Y(a.position.y*this.m_drawScale)),this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*this.m_drawScale,this.Y((a.position.y+this.m_xformScale*a.R.col1.y)*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath(),this.m_sprite.strokeSyle=this.ColorStyle(new b2Color(0,255,0),this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.position.x*this.m_drawScale,this.Y(a.position.y*this.m_drawScale)),this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*this.m_drawScale,this.Y((a.position.y+this.m_xformScale*a.R.col2.y)*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath()},e.prototype.m_drawFlags=0,e.prototype.m_sprite=null,e.prototype.m_drawScale=1,e.prototype.m_lineThickness=1,e.prototype.m_alpha=1,e.prototype.m_fillAlpha=1,e.prototype.m_xformScale=1,b.exports=e}})
