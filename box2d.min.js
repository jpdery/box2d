(function(a){var b={},c=function(d){var e=b[d];if(!e){e=b[d]={};var f=e.exports={};a[d].call(f,c,e,f,window)}return e.exports};window.box2d=c("0")})({0:function(a,b,c,d){var e={};e.Vec2=a("1"),e.BodyDef=a("5"),e.Body=a("6"),e.FixtureDef=a("c"),e.Fixture=a("8"),e.World=a("e"),e.MassData=a("b"),e.PolygonShape=a("10"),e.CircleShape=a("11"),e.DebugDraw=a("12"),b.exports=e},1:function(a,b,c,d){var e=a("2"),f=function(a,b){arguments.length==2&&(this.x=a,this.y=b)};f.Make=function(a,b){return new f(a,b)},f.prototype.SetZero=function(){this.x=0,this.y=0},f.prototype.Set=function(a,b){this.x=a,this.y=b},f.prototype.SetV=function(a){this.x=a.x,this.y=a.y},f.prototype.GetNegative=function(){return new f(-this.x,-this.y)},f.prototype.NegativeSelf=function(){this.x=-this.x,this.y=-this.y},f.prototype.Copy=function(){return new f(this.x,this.y)},f.prototype.Add=function(a){this.x+=a.x,this.y+=a.y},f.prototype.Subtract=function(a){this.x-=a.x,this.y-=a.y},f.prototype.Multiply=function(a){this.x*=a,this.y*=a},f.prototype.MulM=function(a){var b=this.x;this.x=a.col1.x*b+a.col2.x*this.y,this.y=a.col1.y*b+a.col2.y*this.y},f.prototype.MulTM=function(a){var b=e.Dot(this,a.col1);this.y=e.Dot(this,a.col2),this.x=b},f.prototype.CrossVF=function(a){var b=this.x;this.x=a*this.y,this.y=-a*b},f.prototype.CrossFV=function(a){var b=this.x;this.x=-a*this.y,this.y=a*b},f.prototype.MinV=function(a){this.x=this.x<a.x?this.x:a.x,this.y=this.y<a.y?this.y:a.y},f.prototype.MaxV=function(a){this.x=this.x>a.x?this.x:a.x,this.y=this.y>a.y?this.y:a.y},f.prototype.Abs=function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)},f.prototype.Length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},f.prototype.LengthSquared=function(){return this.x*this.x+this.y*this.y},f.prototype.Normalize=function(){var a=Math.sqrt(this.x*this.x+this.y*this.y);if(a<Number.MIN_VALUE)return 0;var b=1/a;return this.x*=b,this.y*=b,a},f.prototype.IsValid=function(){return e.IsValid(this.x)&&e.IsValid(this.y)},f.prototype.x=0,f.prototype.y=0,f.prototype.setZero=f.prototype.SetZero,f.prototype.set=f.prototype.Set,f.prototype.setV=f.prototype.SetV,f.prototype.getNegative=f.prototype.GetNegative,f.prototype.negativeSelf=f.prototype.NegativeSelf,f.prototype.copy=f.prototype.Copy,f.prototype.add=f.prototype.Add,f.prototype.subtract=f.prototype.Subtract,f.prototype.multiply=f.prototype.Multiply,f.prototype.mulM=f.prototype.MulM,f.prototype.mulTM=f.prototype.MulTM,f.prototype.crossVF=f.prototype.CrossVF,f.prototype.crossFV=f.prototype.CrossFV,f.prototype.minV=f.prototype.MinV,f.prototype.maxV=f.prototype.MaxV,f.prototype.abs=f.prototype.Abs,f.prototype.length=f.prototype.Length,f.prototype.lengthSquared=f.prototype.LengthSquared,f.prototype.normalize=f.prototype.Normalize,f.prototype.isValid=f.prototype.IsValid,b.exports=f},2:function(a,b,c,d){var e=a("1"),f=a("3"),g=function(){this.__varz(),this.__constructor.apply(this,arguments)};g.prototype.__constructor=function(){},g.prototype.__varz=function(){},g.IsValid=function(a){return isFinite(a)},g.Dot=function(a,b){return a.x*b.x+a.y*b.y},g.CrossVV=function(a,b){return a.x*b.y-a.y*b.x},g.CrossVF=function(a,b){var c=new e(b*a.y,-b*a.x);return c},g.CrossFV=function(a,b){var c=new e(-a*b.y,a*b.x);return c},g.MulMV=function(a,b){var c=new e(a.col1.x*b.x+a.col2.x*b.y,a.col1.y*b.x+a.col2.y*b.y);return c},g.MulTMV=function(a,b){var c=new e(g.Dot(b,a.col1),g.Dot(b,a.col2));return c},g.MulX=function(a,b){var c=g.MulMV(a.R,b);return c.x+=a.position.x,c.y+=a.position.y,c},g.MulXT=function(a,b){var c=g.SubtractVV(b,a.position),d=c.x*a.R.col1.x+c.y*a.R.col1.y;return c.y=c.x*a.R.col2.x+c.y*a.R.col2.y,c.x=d,c},g.AddVV=function(a,b){var c=new e(a.x+b.x,a.y+b.y);return c},g.SubtractVV=function(a,b){var c=new e(a.x-b.x,a.y-b.y);return c},g.Distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},g.DistanceSquared=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d},g.MulFV=function(a,b){var c=new e(a*b.x,a*b.y);return c},g.AddMM=function(a,b){var c=b2Mat22.FromVV(g.AddVV(a.col1,b.col1),g.AddVV(a.col2,b.col2));return c},g.MulMM=function(a,b){var c=b2Mat22.FromVV(g.MulMV(a,b.col1),g.MulMV(a,b.col2));return c},g.MulTMM=function(a,b){var c=new e(g.Dot(a.col1,b.col1),g.Dot(a.col2,b.col1)),d=new e(g.Dot(a.col1,b.col2),g.Dot(a.col2,b.col2)),f=b2Mat22.FromVV(c,d);return f},g.Abs=function(a){return a>0?a:-a},g.AbsV=function(a){var b=new e(g.Abs(a.x),g.Abs(a.y));return b},g.AbsM=function(a){var b=b2Mat22.FromVV(g.AbsV(a.col1),g.AbsV(a.col2));return b},g.Min=function(a,b){return a<b?a:b},g.MinV=function(a,b){var c=new e(g.Min(a.x,b.x),g.Min(a.y,b.y));return c},g.Max=function(a,b){return a>b?a:b},g.MaxV=function(a,b){var c=new e(g.Max(a.x,b.x),g.Max(a.y,b.y));return c},g.Clamp=function(a,b,c){return a<b?b:a>c?c:a},g.ClampV=function(a,b,c){return g.MaxV(b,g.MinV(a,c))},g.Swap=function(a,b){var c=a[0];a[0]=b[0],b[0]=c},g.Random=function(){return Math.random()*2-1},g.RandomRange=function(a,b){var c=Math.random();return c=(b-a)*c+a,c},g.NextPowerOfTwo=function(a){return a|=a>>1&2147483647,a|=a>>2&1073741823,a|=a>>4&268435455,a|=a>>8&16777215,a|=a>>16&65535,a+1},g.IsPowerOfTwo=function(a){var b=a>0&&(a&a-1)==0;return b},g.b2Vec2_zero=new e(0,0),g.b2Mat22_identity=b2Mat22.FromVV(new e(1,0),new e(0,1)),g.b2Transform_identity=new f(g.b2Vec2_zero,g.b2Mat22_identity),b.exports=g},3:function(a,b,c,d){var e=a("1"),f=a("4"),g=function(){this.__varz(),this.__constructor.apply(this,arguments)};g.prototype.__constructor=function(a,b){a&&(this.position.SetV(a),this.R.SetM(b))},g.prototype.__varz=function(){this.position=new e,this.R=new f},g.prototype.Initialize=function(a,b){this.position.SetV(a),this.R.SetM(b)},g.prototype.SetIdentity=function(){this.position.SetZero(),this.R.SetIdentity()},g.prototype.Set=function(a){this.position.SetV(a.position),this.R.SetM(a.R)},g.prototype.GetAngle=function(){return Math.atan2(this.R.col1.y,this.R.col1.x)},g.prototype.position=new e,g.prototype.R=new f,g.prototype.initialize=g.prototype.Initialize,g.prototype.setIdentity=g.prototype.SetIdentity,g.prototype.set=g.prototype.Set,g.prototype.getAngle=g.prototype.GetAngle,b.exports=g},4:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){this.col1.x=this.col2.y=1},f.prototype.__varz=function(){this.col1=new e,this.col2=new e},f.FromAngle=function(a){var b=new f;return b.Set(a),b},f.FromVV=function(a,b){var c=new f;return c.SetVV(a,b),c},f.prototype.Set=function(a){var b=Math.cos(a),c=Math.sin(a);this.col1.x=b,this.col2.x=-c,this.col1.y=c,this.col2.y=b},f.prototype.SetVV=function(a,b){this.col1.SetV(a),this.col2.SetV(b)},f.prototype.Copy=function(){var a=new f;return a.SetM(this),a},f.prototype.SetM=function(a){this.col1.SetV(a.col1),this.col2.SetV(a.col2)},f.prototype.AddM=function(a){this.col1.x+=a.col1.x,this.col1.y+=a.col1.y,this.col2.x+=a.col2.x,this.col2.y+=a.col2.y},f.prototype.SetIdentity=function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1},f.prototype.SetZero=function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0},f.prototype.GetAngle=function(){return Math.atan2(this.col1.y,this.col1.x)},f.prototype.GetInverse=function(a){var b=this.col1.x,c=this.col2.x,d=this.col1.y,e=this.col2.y,f=b*e-c*d;return f!=0&&(f=1/f),a.col1.x=f*e,a.col2.x=-f*c,a.col1.y=-f*d,a.col2.y=f*b,a},f.prototype.Solve=function(a,b,c){var d=this.col1.x,e=this.col2.x,f=this.col1.y,g=this.col2.y,h=d*g-e*f;return h!=0&&(h=1/h),a.x=h*(g*b-e*c),a.y=h*(d*c-f*b),a},f.prototype.Abs=function(){this.col1.Abs(),this.col2.Abs()},f.prototype.col1=new e,f.prototype.col2=new e,f.prototype.set=f.prototype.Set,f.prototype.setVV=f.prototype.SetVV,f.prototype.copy=f.prototype.Copy,f.prototype.setM=f.prototype.SetM,f.prototype.addM=f.prototype.AddM,f.prototype.setIdentity=f.prototype.SetIdentity,f.prototype.setZero=f.prototype.SetZero,f.prototype.getAngle=f.prototype.GetAngle,f.prototype.getInverse=f.prototype.GetInverse,f.prototype.solve=f.prototype.Solve,f.prototype.abs=f.prototype.Abs,b.exports=f},5:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){this.userData=null,this.position.Set(0,0),this.angle=0,this.linearVelocity.Set(0,0),this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=b2Body.b2_staticBody,this.active=!0,this.inertiaScale=1},f.prototype.__varz=function(){this.position=new e,this.linearVelocity=new e},f.prototype.type=0,f.prototype.position=new e,f.prototype.angle=null,f.prototype.linearVelocity=new e,f.prototype.angularVelocity=null,f.prototype.linearDamping=null,f.prototype.angularDamping=null,f.prototype.allowSleep=null,f.prototype.awake=null,f.prototype.fixedRotation=null,f.prototype.bullet=null,f.prototype.active=null,f.prototype.userData=null,f.prototype.inertiaScale=null,b.exports=f},6:function(a,b,c,d){var e=a("3"),f=a("7"),g=a("1"),h=a("8"),i=a("c"),j=a("5"),k=a("d"),l=a("2"),m=function(){this.__varz(),this.__constructor.apply(this,arguments)};m.prototype.__constructor=function(a,b){this.m_flags=0,a.bullet&&(this.m_flags|=m.e_bulletFlag),a.fixedRotation&&(this.m_flags|=m.e_fixedRotationFlag),a.allowSleep&&(this.m_flags|=m.e_allowSleepFlag),a.awake&&(this.m_flags|=m.e_awakeFlag),a.active&&(this.m_flags|=m.e_activeFlag),this.m_world=b,this.m_xf.position.SetV(a.position),this.m_xf.R.Set(a.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=a.angle;var c=this.m_xf.R,d=this.m_sweep.localCenter;this.m_sweep.c.x=c.col1.x*d.x+c.col2.x*d.y,this.m_sweep.c.y=c.col1.y*d.x+c.col2.y*d.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(a.linearVelocity),this.m_angularVelocity=a.angularVelocity,this.m_linearDamping=a.linearDamping,this.m_angularDamping=a.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=a.type,this.m_type==m.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=a.inertiaScale,this.m_userData=a.userData,this.m_fixtureList=null,this.m_fixtureCount=0},m.prototype.__varz=function(){this.m_xf=new e,this.m_sweep=new f,this.m_linearVelocity=new g,this.m_force=new g},m.b2_staticBody=0,m.b2_kinematicBody=1,m.b2_dynamicBody=2,m.s_xf1=new e,m.e_islandFlag=1,m.e_awakeFlag=2,m.e_allowSleepFlag=4,m.e_bulletFlag=8,m.e_fixedRotationFlag=16,m.e_activeFlag=32,m.prototype.connectEdges=function(a,b,c){var d=Math.atan2(b.GetDirectionVector().y,b.GetDirectionVector().x),e=Math.tan((d-c)*.5),f=l.MulFV(e,b.GetDirectionVector());f=l.SubtractVV(f,b.GetNormalVector()),f=l.MulFV(k.b2_toiSlop,f),f=l.AddVV(f,b.GetVertex1());var g=l.AddVV(a.GetDirectionVector(),b.GetDirectionVector());g.Normalize();var h=l.Dot(a.GetDirectionVector(),b.GetNormalVector())>0;return a.SetNextEdge(b,f,g,h),b.SetPrevEdge(a,f,g,h),d},m.prototype.SynchronizeFixtures=function(){var a=m.s_xf1;a.R.Set(this.m_sweep.a0);var b=a.R,c=this.m_sweep.localCenter;a.position.x=this.m_sweep.c0.x-(b.col1.x*c.x+b.col2.x*c.y),a.position.y=this.m_sweep.c0.y-(b.col1.y*c.x+b.col2.y*c.y);var d,e=this.m_world.m_contactManager.m_broadPhase;for(d=this.m_fixtureList;d;d=d.m_next)d.Synchronize(e,a,this.m_xf)},m.prototype.SynchronizeTransform=function(){this.m_xf.R.Set(this.m_sweep.a);var a=this.m_xf.R,b=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(a.col1.x*b.x+a.col2.x*b.y),this.m_xf.position.y=this.m_sweep.c.y-(a.col1.y*b.x+a.col2.y*b.y)},m.prototype.ShouldCollide=function(a){if(this.m_type!=m.b2_dynamicBody&&a.m_type!=m.b2_dynamicBody)return!1;for(var b=this.m_jointList;b;b=b.next)if(b.other==a&&b.joint.m_collideConnected==0)return!1;return!0},m.prototype.Advance=function(a){this.m_sweep.Advance(a),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()},m.prototype.CreateFixture=function(a){if(this.m_world.IsLocked()==1)return null;var b=new h;b.Create(this,this.m_xf,a);if(this.m_flags&m.e_activeFlag){var c=this.m_world.m_contactManager.m_broadPhase;b.CreateProxy(c,this.m_xf)}return b.m_next=this.m_fixtureList,this.m_fixtureList=b,++this.m_fixtureCount,b.m_body=this,b.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=b2World.e_newFixture,b},m.prototype.CreateFixture2=function(a,b){var c=new i;return c.shape=a,c.density=b,this.CreateFixture(c)},m.prototype.DestroyFixture=function(a){if(this.m_world.IsLocked()==1)return;var b=this.m_fixtureList,c=null,d=!1;while(b!=null){if(b==a){c?c.m_next=a.m_next:this.m_fixtureList=a.m_next,d=!0;break}c=b,b=b.m_next}var e=this.m_contactList;while(e){var f=e.contact;e=e.next;var g=f.GetFixtureA(),h=f.GetFixtureB();(a==g||a==h)&&this.m_world.m_contactManager.Destroy(f)}if(this.m_flags&m.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;a.DestroyProxy(i)}a.Destroy(),a.m_body=null,a.m_next=null,--this.m_fixtureCount,this.ResetMassData()},m.prototype.SetPositionAndAngle=function(a,b){var c;if(this.m_world.IsLocked()==1)return;this.m_xf.R.Set(b),this.m_xf.position.SetV(a);var d=this.m_xf.R,e=this.m_sweep.localCenter;this.m_sweep.c.x=d.col1.x*e.x+d.col2.x*e.y,this.m_sweep.c.y=d.col1.y*e.x+d.col2.y*e.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=b;var f=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.Synchronize(f,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()},m.prototype.SetTransform=function(a){this.SetPositionAndAngle(a.position,a.GetAngle())},m.prototype.GetTransform=function(){return this.m_xf},m.prototype.GetPosition=function(){return this.m_xf.position},m.prototype.SetPosition=function(a){this.SetPositionAndAngle(a,this.GetAngle())},m.prototype.GetAngle=function(){return this.m_sweep.a},m.prototype.SetAngle=function(a){this.SetPositionAndAngle(this.GetPosition(),a)},m.prototype.GetWorldCenter=function(){return this.m_sweep.c},m.prototype.GetLocalCenter=function(){return this.m_sweep.localCenter},m.prototype.SetLinearVelocity=function(a){if(this.m_type==m.b2_staticBody)return;this.m_linearVelocity.SetV(a)},m.prototype.GetLinearVelocity=function(){return this.m_linearVelocity},m.prototype.SetAngularVelocity=function(a){if(this.m_type==m.b2_staticBody)return;this.m_angularVelocity=a},m.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},m.prototype.GetDefinition=function(){var a=new j;return a.type=this.GetType(),a.allowSleep=(this.m_flags&m.e_allowSleepFlag)==m.e_allowSleepFlag,a.angle=this.GetAngle(),a.angularDamping=this.m_angularDamping,a.angularVelocity=this.m_angularVelocity,a.fixedRotation=(this.m_flags&m.e_fixedRotationFlag)==m.e_fixedRotationFlag,a.bullet=(this.m_flags&m.e_bulletFlag)==m.e_bulletFlag,a.awake=(this.m_flags&m.e_awakeFlag)==m.e_awakeFlag,a.linearDamping=this.m_linearDamping,a.linearVelocity.SetV(this.GetLinearVelocity()),a.position=this.GetPosition(),a.userData=this.GetUserData(),a},m.prototype.ApplyForce=function(a,b){if(this.m_type!=m.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_force.x+=a.x,this.m_force.y+=a.y,this.m_torque+=(b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x},m.prototype.ApplyTorque=function(a){if(this.m_type!=m.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_torque+=a},m.prototype.ApplyImpulse=function(a,b){if(this.m_type!=m.b2_dynamicBody)return;this.IsAwake()==0&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*a.x,this.m_linearVelocity.y+=this.m_invMass*a.y,this.m_angularVelocity+=this.m_invI*((b.x-this.m_sweep.c.x)*a.y-(b.y-this.m_sweep.c.y)*a.x)},m.prototype.Split=function(a){var b=this.GetLinearVelocity().Copy(),c=this.GetAngularVelocity(),d=this.GetWorldCenter(),e=this,f=this.m_world.CreateBody(this.GetDefinition()),g;for(var h=e.m_fixtureList;h;)if(a(h)){var i=h.m_next;g?g.m_next=i:e.m_fixtureList=i,e.m_fixtureCount--,h.m_next=f.m_fixtureList,f.m_fixtureList=h,f.m_fixtureCount++,h.m_body=f,h=i}else g=h,h=h.m_next;e.ResetMassData(),f.ResetMassData();var j=e.GetWorldCenter(),k=f.GetWorldCenter(),m=l.AddVV(b,l.CrossFV(c,l.SubtractVV(j,d))),n=l.AddVV(b,l.CrossFV(c,l.SubtractVV(k,d)));return e.SetLinearVelocity(m),f.SetLinearVelocity(n),e.SetAngularVelocity(c),f.SetAngularVelocity(c),e.SynchronizeFixtures(),f.SynchronizeFixtures(),f},m.prototype.Merge=function(a){var b;for(b=a.m_fixtureList;b;){var c=b.m_next;a.m_fixtureCount--,b.m_next=this.m_fixtureList,this.m_fixtureList=b,this.m_fixtureCount++,b.m_body=e,b=c}d.m_fixtureCount=0;var d=this,e=a,f=d.GetWorldCenter(),g=e.GetWorldCenter(),h=d.GetLinearVelocity().Copy(),i=e.GetLinearVelocity().Copy(),j=d.GetAngularVelocity(),k=e.GetAngularVelocity();d.ResetMassData(),this.SynchronizeFixtures()},m.prototype.GetMass=function(){return this.m_mass},m.prototype.GetInertia=function(){return this.m_I},m.prototype.GetMassData=function(a){a.mass=this.m_mass,a.I=this.m_I,a.center.SetV(this.m_sweep.localCenter)},m.prototype.SetMassData=function(a){k.b2Assert(this.m_world.IsLocked()==0);if(this.m_world.IsLocked()==1)return;if(this.m_type!=m.b2_dynamicBody)return;this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=a.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,a.I>0&&(this.m_flags&m.e_fixedRotationFlag)==0&&(this.m_I=a.I-this.m_mass*(a.center.x*a.center.x+a.center.y*a.center.y),this.m_invI=1/this.m_I);var b=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a.center),this.m_sweep.c0.SetV(l.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-b.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-b.x)},m.prototype.ResetMassData=function(){this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero();if(this.m_type==m.b2_staticBody||this.m_type==m.b2_kinematicBody)return;var a=g.Make(0,0);for(var b=this.m_fixtureList;b;b=b.m_next){if(b.m_density==0)continue;var c=b.GetMassData();this.m_mass+=c.mass,a.x+=c.center.x*c.mass,a.y+=c.center.y*c.mass,this.m_I+=c.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,a.x*=this.m_invMass,a.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&(this.m_flags&m.e_fixedRotationFlag)==0?(this.m_I-=this.m_mass*(a.x*a.x+a.y*a.y),this.m_I*=this.m_inertiaScale,k.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var d=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(a),this.m_sweep.c0.SetV(l.MulX(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-d.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-d.x)},m.prototype.GetWorldPoint=function(a){var b=this.m_xf.R,c=new g(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);return c.x+=this.m_xf.position.x,c.y+=this.m_xf.position.y,c},m.prototype.GetWorldVector=function(a){return l.MulMV(this.m_xf.R,a)},m.prototype.GetLocalPoint=function(a){return l.MulXT(this.m_xf,a)},m.prototype.GetLocalVector=function(a){return l.MulTMV(this.m_xf.R,a)},m.prototype.GetLinearVelocityFromWorldPoint=function(a){return new g(this.m_linearVelocity.x-this.m_angularVelocity*(a.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(a.x-this.m_sweep.c.x))},m.prototype.GetLinearVelocityFromLocalPoint=function(a){var b=this.m_xf.R,c=new g(b.col1.x*a.x+b.col2.x*a.y,b.col1.y*a.x+b.col2.y*a.y);return c.x+=this.m_xf.position.x,c.y+=this.m_xf.position.y,new g(this.m_linearVelocity.x-this.m_angularVelocity*(c.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(c.x-this.m_sweep.c.x))},m.prototype.GetLinearDamping=function(){return this.m_linearDamping},m.prototype.SetLinearDamping=function(a){this.m_linearDamping=a},m.prototype.GetAngularDamping=function(){return this.m_angularDamping},m.prototype.SetAngularDamping=function(a){this.m_angularDamping=a},m.prototype.SetType=function(a){if(this.m_type==a)return;this.m_type=a,this.ResetMassData(),this.m_type==m.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var b=this.m_contactList;b;b=b.next)b.contact.FlagForFiltering()},m.prototype.GetType=function(){return this.m_type},m.prototype.SetBullet=function(a){a?this.m_flags|=m.e_bulletFlag:this.m_flags&=~m.e_bulletFlag},m.prototype.IsBullet=function(){return(this.m_flags&m.e_bulletFlag)==m.e_bulletFlag},m.prototype.SetSleepingAllowed=function(a){a?this.m_flags|=m.e_allowSleepFlag:(this.m_flags&=~m.e_allowSleepFlag,this.SetAwake(!0))},m.prototype.SetAwake=function(a){a?(this.m_flags|=m.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~m.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},m.prototype.IsAwake=function(){return(this.m_flags&m.e_awakeFlag)==m.e_awakeFlag},m.prototype.SetFixedRotation=function(a){a?this.m_flags|=m.e_fixedRotationFlag:this.m_flags&=~m.e_fixedRotationFlag,this.ResetMassData()},m.prototype.IsFixedRotation=function(){return(this.m_flags&m.e_fixedRotationFlag)==m.e_fixedRotationFlag},m.prototype.SetActive=function(a){if(a==this.IsActive())return;var b,c;if(a){this.m_flags|=m.e_activeFlag,b=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.CreateProxy(b,this.m_xf)}else{this.m_flags&=~m.e_activeFlag,b=this.m_world.m_contactManager.m_broadPhase;for(c=this.m_fixtureList;c;c=c.m_next)c.DestroyProxy(b);var d=this.m_contactList;while(d){var e=d;d=d.next,this.m_world.m_contactManager.Destroy(e.contact)}this.m_contactList=null}},m.prototype.IsActive=function(){return(this.m_flags&m.e_activeFlag)==m.e_activeFlag},m.prototype.IsSleepingAllowed=function(){return(this.m_flags&m.e_allowSleepFlag)==m.e_allowSleepFlag},m.prototype.GetFixtureList=function(){return this.m_fixtureList},m.prototype.GetJointList=function(){return this.m_jointList},m.prototype.GetControllerList=function(){return this.m_controllerList},m.prototype.GetContactList=function(){return this.m_contactList},m.prototype.GetNext=function(){return this.m_next},m.prototype.GetUserData=function(){return this.m_userData},m.prototype.SetUserData=function(a){this.m_userData=a},m.prototype.GetWorld=function(){return this.m_world},m.prototype.m_flags=0,m.prototype.m_type=0,m.prototype.m_islandIndex=0,m.prototype.m_xf=new e,m.prototype.m_sweep=new f,m.prototype.m_linearVelocity=new g,m.prototype.m_angularVelocity=null,m.prototype.m_force=new g,m.prototype.m_torque=null,m.prototype.m_world=null,m.prototype.m_prev=null,m.prototype.m_next=null,m.prototype.m_fixtureList=null,m.prototype.m_fixtureCount=0,m.prototype.m_controllerList=null,m.prototype.m_controllerCount=0,m.prototype.m_jointList=null,m.prototype.m_contactList=null,m.prototype.m_mass=null,m.prototype.m_invMass=null,m.prototype.m_I=null,m.prototype.m_invI=null,m.prototype.m_inertiaScale=null,m.prototype.m_linearDamping=null,m.prototype.m_angularDamping=null,m.prototype.m_sleepTime=null,m.prototype.m_userData=null,m.prototype.connectEdges=m.prototype.connectEdges,m.prototype.synchronizeFixtures=m.prototype.SynchronizeFixtures,m.prototype.synchronizeTransform=m.prototype.SynchronizeTransform,m.prototype.shouldCollide=m.prototype.ShouldCollide,m.prototype.advance=m.prototype.Advance,m.prototype.createFixture=m.prototype.CreateFixture,m.prototype.createFixture2=m.prototype.CreateFixture2,m.prototype.destroyFixture=m.prototype.DestroyFixture,m.prototype.setPositionAndAngle=m.prototype.SetPositionAndAngle,m.prototype.setTransform=m.prototype.SetTransform,m.prototype.getTransform=m.prototype.GetTransform,m.prototype.getPosition=m.prototype.GetPosition,m.prototype.setPosition=m.prototype.SetPosition,m.prototype.getAngle=m.prototype.GetAngle,m.prototype.setAngle=m.prototype.SetAngle,m.prototype.getWorldCenter=m.prototype.GetWorldCenter,m.prototype.getLocalCenter=m.prototype.GetLocalCenter,m.prototype.setLinearVelocity=m.prototype.SetLinearVelocity,m.prototype.getLinearVelocity=m.prototype.GetLinearVelocity,m.prototype.setAngularVelocity=m.prototype.SetAngularVelocity,m.prototype.getAngularVelocity=m.prototype.GetAngularVelocity,m.prototype.getDefinition=m.prototype.GetDefinition,m.prototype.applyForce=m.prototype.ApplyForce,m.prototype.applyTorque=m.prototype.ApplyTorque,m.prototype.applyImpulse=m.prototype.ApplyImpulse,m.prototype.split=m.prototype.Split,m.prototype.merge=m.prototype.Merge,m.prototype.getMass=m.prototype.GetMass,m.prototype.getInertia=m.prototype.GetInertia,m.prototype.getMassData=m.prototype.GetMassData,m.prototype.setMassData=m.prototype.SetMassData,m.prototype.resetMassData=m.prototype.ResetMassData,m.prototype.getWorldPoint=m.prototype.GetWorldPoint,m.prototype.getWorldVector=m.prototype.GetWorldVector,m.prototype.getLocalPoint=m.prototype.GetLocalPoint,m.prototype.getLocalVector=m.prototype.GetLocalVector,m.prototype.getLinearVelocityFromWorldPoint=m.prototype.GetLinearVelocityFromWorldPoint,m.prototype.getLinearVelocityFromLocalPoint=m.prototype.GetLinearVelocityFromLocalPoint,m.prototype.getLinearDamping=m.prototype.GetLinearDamping,m.prototype.setLinearDamping=m.prototype.SetLinearDamping,m.prototype.getAngularDamping=m.prototype.GetAngularDamping,m.prototype.setAngularDamping=m.prototype.SetAngularDamping,m.prototype.setType=m.prototype.SetType,m.prototype.getType=m.prototype.GetType,m.prototype.setBullet=m.prototype.SetBullet,m.prototype.isBullet=m.prototype.IsBullet,m.prototype.setSleepingAllowed=m.prototype.SetSleepingAllowed,m.prototype.setAwake=m.prototype.SetAwake,m.prototype.isAwake=m.prototype.IsAwake,m.prototype.setFixedRotation=m.prototype.SetFixedRotation,m.prototype.isFixedRotation=m.prototype.IsFixedRotation,m.prototype.setActive=m.prototype.SetActive,m.prototype.isActive=m.prototype.IsActive,m.prototype.isSleepingAllowed=m.prototype.IsSleepingAllowed,m.prototype.getFixtureList=m.prototype.GetFixtureList,m.prototype.getJointList=m.prototype.GetJointList,m.prototype.getControllerList=m.prototype.GetControllerList,m.prototype.getContactList=m.prototype.GetContactList,m.prototype.getNext=m.prototype.GetNext,m.prototype.getUserData=m.prototype.GetUserData,m.prototype.setUserData=m.prototype.SetUserData,m.prototype.getWorld=m.prototype.GetWorld,b.exports=m},7:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){},f.prototype.__varz=function(){this.localCenter=new e,this.c0=new e,this.c=new e},f.prototype.Set=function(a){this.localCenter.SetV(a.localCenter),this.c0.SetV(a.c0),this.c.SetV(a.c),this.a0=a.a0,this.a=a.a,this.t0=a.t0},f.prototype.Copy=function(){var a=new f;return a.localCenter.SetV(this.localCenter),a.c0.SetV(this.c0),a.c.SetV(this.c),a.a0=this.a0,a.a=this.a,a.t0=this.t0,a},f.prototype.GetTransform=function(a,b){a.position.x=(1-b)*this.c0.x+b*this.c.x,a.position.y=(1-b)*this.c0.y+b*this.c.y;var c=(1-b)*this.a0+b*this.a;a.R.Set(c);var d=a.R;a.position.x-=d.col1.x*this.localCenter.x+d.col2.x*this.localCenter.y,a.position.y-=d.col1.y*this.localCenter.x+d.col2.y*this.localCenter.y},f.prototype.Advance=function(a){if(this.t0<a&&1-this.t0>Number.MIN_VALUE){var b=(a-this.t0)/(1-this.t0);this.c0.x=(1-b)*this.c0.x+b*this.c.x,this.c0.y=(1-b)*this.c0.y+b*this.c.y,this.a0=(1-b)*this.a0+b*this.a,this.t0=a}},f.prototype.localCenter=new e,f.prototype.c0=new e,f.prototype.c=new e,f.prototype.a0=null,f.prototype.a=null,f.prototype.t0=null,f.prototype.set=f.prototype.Set,f.prototype.copy=f.prototype.Copy,f.prototype.getTransform=f.prototype.GetTransform,f.prototype.advance=f.prototype.Advance,b.exports=f},8:function(a,b,c,d){var e=a("9"),f=a("a"),g=a("b"),h=a("2"),i=function(){this.__varz(),this.__constructor.apply(this,arguments)};i.prototype.__constructor=function(){this.m_aabb=new e,this.m_userData=null,this.m_body=null,this.m_next=null,this.m_shape=null,this.m_density=0,this.m_friction=0,this.m_restitution=0},i.prototype.__varz=function(){this.m_filter=new f},i.prototype.Create=function(a,b,c){this.m_userData=c.userData,this.m_friction=c.friction,this.m_restitution=c.restitution,this.m_body=a,this.m_next=null,this.m_filter=c.filter.Copy(),this.m_isSensor=c.isSensor,this.m_shape=c.shape.Copy(),this.m_density=c.density},i.prototype.Destroy=function(){this.m_shape=null},i.prototype.CreateProxy=function(a,b){this.m_shape.ComputeAABB(this.m_aabb,b),this.m_proxy=a.CreateProxy(this.m_aabb,this)},i.prototype.DestroyProxy=function(a){if(this.m_proxy==null)return;a.DestroyProxy(this.m_proxy),this.m_proxy=null},i.prototype.Synchronize=function(a,b,c){if(!this.m_proxy)return;var d=new e,f=new e;this.m_shape.ComputeAABB(d,b),this.m_shape.ComputeAABB(f,c),this.m_aabb.Combine(d,f);var g=h.SubtractVV(c.position,b.position);a.MoveProxy(this.m_proxy,this.m_aabb,g)},i.prototype.GetType=function(){return this.m_shape.GetType()},i.prototype.GetShape=function(){return this.m_shape},i.prototype.SetSensor=function(a){if(this.m_isSensor==a)return;this.m_isSensor=a;if(this.m_body==null)return;var b=this.m_body.GetContactList();while(b){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();(d==this||e==this)&&c.SetSensor(d.IsSensor()||e.IsSensor()),b=b.next}},i.prototype.IsSensor=function(){return this.m_isSensor},i.prototype.SetFilterData=function(a){this.m_filter=a.Copy();if(this.m_body)return;var b=this.m_body.GetContactList();while(b){var c=b.contact,d=c.GetFixtureA(),e=c.GetFixtureB();(d==this||e==this)&&c.FlagForFiltering(),b=b.next}},i.prototype.GetFilterData=function(){return this.m_filter.Copy()},i.prototype.GetBody=function(){return this.m_body},i.prototype.GetNext=function(){return this.m_next},i.prototype.GetUserData=function(){return this.m_userData},i.prototype.SetUserData=function(a){this.m_userData=a},i.prototype.TestPoint=function(a){return this.m_shape.TestPoint(this.m_body.GetTransform(),a)},i.prototype.RayCast=function(a,b){return this.m_shape.RayCast(a,b,this.m_body.GetTransform())},i.prototype.GetMassData=function(a){return a==null&&(a=new g),this.m_shape.ComputeMass(a,this.m_density),a},i.prototype.SetDensity=function(a){this.m_density=a},i.prototype.GetDensity=function(){return this.m_density},i.prototype.GetFriction=function(){return this.m_friction},i.prototype.SetFriction=function(a){this.m_friction=a},i.prototype.GetRestitution=function(){return this.m_restitution},i.prototype.SetRestitution=function(a){this.m_restitution=a},i.prototype.GetAABB=function(){return this.m_aabb},i.prototype.m_massData=null,i.prototype.m_aabb=null,i.prototype.m_density=null,i.prototype.m_next=null,i.prototype.m_body=null,i.prototype.m_shape=null,i.prototype.m_friction=null,i.prototype.m_restitution=null,i.prototype.m_proxy=null,i.prototype.m_filter=new f,i.prototype.m_isSensor=null,i.prototype.m_userData=null,i.prototype.create=i.prototype.Create,i.prototype.destroy=i.prototype.Destroy,i.prototype.createProxy=i.prototype.CreateProxy,i.prototype.destroyProxy=i.prototype.DestroyProxy,i.prototype.synchronize=i.prototype.Synchronize,i.prototype.getType=i.prototype.GetType,i.prototype.getShape=i.prototype.GetShape,i.prototype.setSensor=i.prototype.SetSensor,i.prototype.isSensor=i.prototype.IsSensor,i.prototype.setFilterData=i.prototype.SetFilterData,i.prototype.getFilterData=i.prototype.GetFilterData,i.prototype.getBody=i.prototype.GetBody,i.prototype.getNext=i.prototype.GetNext,i.prototype.getUserData=i.prototype.GetUserData,i.prototype.setUserData=i.prototype.SetUserData,i.prototype.testPoint=i.prototype.TestPoint,i.prototype.rayCast=i.prototype.RayCast,i.prototype.getMassData=i.prototype.GetMassData,i.prototype.setDensity=i.prototype.SetDensity,i.prototype.getDensity=i.prototype.GetDensity,i.prototype.getFriction=i.prototype.GetFriction,i.prototype.setFriction=i.prototype.SetFriction,i.prototype.getRestitution=i.prototype.GetRestitution,i.prototype.setRestitution=i.prototype.SetRestitution,i.prototype.getAABB=i.prototype.GetAABB,b.exports=i},9:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){},f.prototype.__varz=function(){this.lowerBound=new e,this.upperBound=new e},f.Combine=function(a,b){var c=new f;return c.Combine(a,b),c},f.prototype.IsValid=function(){var a=this.upperBound.x-this.lowerBound.x,b=this.upperBound.y-this.lowerBound.y,c=a>=0&&b>=0;return c=c&&this.lowerBound.IsValid()&&this.upperBound.IsValid(),c},f.prototype.GetCenter=function(){return new e((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)},f.prototype.GetExtents=function(){return new e((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)},f.prototype.Contains=function(a){var b=this.lowerBound.x<=a.lowerBound.x&&this.lowerBound.y<=a.lowerBound.y&&a.upperBound.x<=this.upperBound.x&&a.upperBound.y<=this.upperBound.y;return b},f.prototype.RayCast=function(a,b){var c=-Number.MAX_VALUE,d=Number.MAX_VALUE,e=b.p1.x,f=b.p1.y,g=b.p2.x-b.p1.x,h=b.p2.y-b.p1.y,i=Math.abs(g),j=Math.abs(h),k=a.normal,l,m,n,o,p;if(i<Number.MIN_VALUE){if(e<this.lowerBound.x||this.upperBound.x<e)return!1}else{l=1/g,m=(this.lowerBound.x-e)*l,n=(this.upperBound.x-e)*l,p=-1,m>n&&(o=m,m=n,n=o,p=1),m>c&&(k.x=p,k.y=0,c=m),d=Math.min(d,n);if(c>d)return!1}if(j<Number.MIN_VALUE){if(f<this.lowerBound.y||this.upperBound.y<f)return!1}else{l=1/h,m=(this.lowerBound.y-f)*l,n=(this.upperBound.y-f)*l,p=-1,m>n&&(o=m,m=n,n=o,p=1),m>c&&(k.y=p,k.x=0,c=m),d=Math.min(d,n);if(c>d)return!1}return a.fraction=c,!0},f.prototype.TestOverlap=function(a){var b=a.lowerBound.x-this.upperBound.x,c=a.lowerBound.y-this.upperBound.y,d=this.lowerBound.x-a.upperBound.x,e=this.lowerBound.y-a.upperBound.y;return b>0||c>0?!1:d>0||e>0?!1:!0},f.prototype.Combine=function(a,b){this.lowerBound.x=Math.min(a.lowerBound.x,b.lowerBound.x),this.lowerBound.y=Math.min(a.lowerBound.y,b.lowerBound.y),this.upperBound.x=Math.max(a.upperBound.x,b.upperBound.x),this.upperBound.y=Math.max(a.upperBound.y,b.upperBound.y)},f.prototype.lowerBound=new e,f.prototype.upperBound=new e,f.prototype.isValid=f.prototype.IsValid,f.prototype.getCenter=f.prototype.GetCenter,f.prototype.getExtents=f.prototype.GetExtents,f.prototype.contains=f.prototype.Contains,f.prototype.rayCast=f.prototype.RayCast,f.prototype.testOverlap=f.prototype.TestOverlap,f.prototype.combine=f.prototype.Combine,b.exports=f},a:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){},e.prototype.__varz=function(){this.categoryBits=1,this.maskBits=65535},e.prototype.Copy=function(){var a=new e;return a.categoryBits=this.categoryBits,a.maskBits=this.maskBits,a.groupIndex=this.groupIndex,a},e.prototype.categoryBits=1,e.prototype.maskBits=65535,e.prototype.groupIndex=0,e.prototype.copy=e.prototype.Copy,b.exports=e},b:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){},f.prototype.__varz=function(){this.center=new e(0,0)},f.prototype.mass=0,f.prototype.center=new e(0,0),f.prototype.I=0,b.exports=f},c:function(a,b,c,d){var e=a("a"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){this.shape=null,this.userData=null,this.friction=.2,this.restitution=0,this.density=0,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0,this.isSensor=!1},f.prototype.__varz=function(){this.filter=new e},f.prototype.shape=null,f.prototype.userData=null,f.prototype.friction=null,f.prototype.restitution=null,f.prototype.density=null,f.prototype.isSensor=null,f.prototype.filter=new e,b.exports=f},d:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){},e.prototype.__varz=function(){},e.b2MixFriction=function(a,b){return Math.sqrt(a*b)},e.b2MixRestitution=function(a,b){return a>b?a:b},e.b2Assert=function(a){if(!a)throw"Assertion Failed"},e.VERSION="2.1alpha",e.USHRT_MAX=65535,e.b2_pi=Math.PI,e.b2_maxManifoldPoints=2,e.b2_aabbExtension=.1,e.b2_aabbMultiplier=2,e.b2_polygonRadius=2*e.b2_linearSlop,e.b2_linearSlop=.005,e.b2_angularSlop=2/180*e.b2_pi,e.b2_toiSlop=8*e.b2_linearSlop,e.b2_maxTOIContactsPerIsland=32,e.b2_maxTOIJointsPerIsland=32,e.b2_velocityThreshold=1,e.b2_maxLinearCorrection=.2,e.b2_maxAngularCorrection=8/180*e.b2_pi,e.b2_maxTranslation=2,e.b2_maxTranslationSquared=e.b2_maxTranslation*e.b2_maxTranslation,e.b2_maxRotation=.5*e.b2_pi,e.b2_maxRotationSquared=e.b2_maxRotation*e.b2_maxRotation,e.b2_contactBaumgarte=.2,e.b2_timeToSleep=.5,e.b2_linearSleepTolerance=.01,e.b2_angularSleepTolerance=2/180*e.b2_pi,b.exports=e},e:function(a,b,c,d){var e=a("5"),f=a("f"),g=a("q"),h=a("w"),i=a("r"),j=a("7"),k=a("3"),l=a("y"),m=a("6"),n=a("1"),o=a("9"),p=a("z"),q=a("l"),r=a("d"),s=a("2"),t=function(){this.__varz(),this.__constructor.apply(this,arguments)};t.prototype.__constructor=function(a,b){this.m_destructionListener=null,this.m_debugDraw=null,this.m_bodyList=null,this.m_contactList=null,this.m_jointList=null,this.m_controllerList=null,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,t.m_warmStarting=!0,t.m_continuousPhysics=!0,this.m_allowSleep=b,this.m_gravity=a,this.m_inv_dt0=0,this.m_contactManager.m_world=this;var c=new e;this.m_groundBody=this.CreateBody(c)},t.prototype.__varz=function(){this.s_stack=new Array,this.m_contactManager=new f,this.m_contactSolver=new g,this.m_island=new h},t.s_timestep2=new i,t.s_backupA=new j,t.s_backupB=new j,t.s_timestep=new i,t.s_queue=new Array,t.e_newFixture=1,t.e_locked=2,t.s_xf=new k,t.s_jointColor=new l(.5,.8,.8),t.m_warmStarting=null,t.m_continuousPhysics=null,t.prototype.Solve=function(a){var b;for(var c=this.m_controllerList;c;c=c.m_next)c.Step(a);var d=this.m_island;d.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver);for(b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~m.e_islandFlag;for(var e=this.m_contactList;e;e=e.m_next)e.m_flags&=~b2Contact.e_islandFlag;for(var f=this.m_jointList;f;f=f.m_next)f.m_islandFlag=!1;var g=this.m_bodyCount,h=this.s_stack;for(var i=this.m_bodyList;i;i=i.m_next){if(i.m_flags&m.e_islandFlag)continue;if(i.IsAwake()==0||i.IsActive()==0)continue;if(i.GetType()==m.b2_staticBody)continue;d.Clear();var j=0;h[j++]=i,i.m_flags|=m.e_islandFlag;while(j>0){b=h[--j],d.AddBody(b),b.IsAwake()==0&&b.SetAwake(!0);if(b.GetType()==m.b2_staticBody)continue;var k;for(var l=b.m_contactList;l;l=l.next){if(l.contact.m_flags&b2Contact.e_islandFlag)continue;if(l.contact.IsSensor()==1||l.contact.IsEnabled()==0||l.contact.IsTouching()==0)continue;d.AddContact(l.contact),l.contact.m_flags|=b2Contact.e_islandFlag,k=l.other;if(k.m_flags&m.e_islandFlag)continue;h[j++]=k,k.m_flags|=m.e_islandFlag}for(var n=b.m_jointList;n;n=n.next){if(n.joint.m_islandFlag==1)continue;k=n.other;if(k.IsActive()==0)continue;d.AddJoint(n.joint),n.joint.m_islandFlag=!0;if(k.m_flags&m.e_islandFlag)continue;h[j++]=k,k.m_flags|=m.e_islandFlag}}d.Solve(a,this.m_gravity,this.m_allowSleep);for(var o=0;o<d.m_bodyCount;++o)b=d.m_bodies[o],b.GetType()==m.b2_staticBody&&(b.m_flags&=~m.e_islandFlag)}for(o=0;o<h.length;++o){if(!h[o])break;h[o]=null}for(b=this.m_bodyList;b;b=b.m_next){if(b.IsAwake()==0||b.IsActive()==0)continue;if(b.GetType()==m.b2_staticBody)continue;b.SynchronizeFixtures()}this.m_contactManager.FindNewContacts()},t.prototype.SolveTOI=function(a){var b,c,d,e,f,g,h,i=this.m_island;i.Initialize(this.m_bodyCount,r.b2_maxTOIContactsPerIsland,r.b2_maxTOIJointsPerIsland,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var j=t.s_queue;for(b=this.m_bodyList;b;b=b.m_next)b.m_flags&=~m.e_islandFlag,b.m_sweep.t0=0;var k;for(k=this.m_contactList;k;k=k.m_next)k.m_flags&=~(b2Contact.e_toiFlag|b2Contact.e_islandFlag);for(h=this.m_jointList;h;h=h.m_next)h.m_islandFlag=!1;for(;;){var l=null,n=1;for(k=this.m_contactList;k;k=k.m_next){if(k.IsSensor()==1||k.IsEnabled()==0||k.IsContinuous()==0)continue;var o=1;if(k.m_flags&b2Contact.e_toiFlag)o=k.m_toi;else{c=k.m_fixtureA,d=k.m_fixtureB,e=c.m_body,f=d.m_body;if(!(e.GetType()==m.b2_dynamicBody&&e.IsAwake()!=0||f.GetType()==m.b2_dynamicBody&&f.IsAwake()!=0))continue;var p=e.m_sweep.t0;e.m_sweep.t0<f.m_sweep.t0?(p=f.m_sweep.t0,e.m_sweep.Advance(p)):f.m_sweep.t0<e.m_sweep.t0&&(p=e.m_sweep.t0,f.m_sweep.Advance(p)),o=k.ComputeTOI(e.m_sweep,f.m_sweep),r.b2Assert(0<=o&&o<=1),o>0&&o<1&&(o=(1-o)*p+o,o>1&&(o=1)),k.m_toi=o,k.m_flags|=b2Contact.e_toiFlag}Number.MIN_VALUE<o&&o<n&&(l=k,n=o)}if(l==null||1-100*Number.MIN_VALUE<n)break;c=l.m_fixtureA,d=l.m_fixtureB,e=c.m_body,f=d.m_body,t.s_backupA.Set(e.m_sweep),t.s_backupB.Set(f.m_sweep),e.Advance(n),f.Advance(n),l.Update(this.m_contactManager.m_contactListener),l.m_flags&=~b2Contact.e_toiFlag;if(l.IsSensor()==1||l.IsEnabled()==0){e.m_sweep.Set(t.s_backupA),f.m_sweep.Set(t.s_backupB),e.SynchronizeTransform(),f.SynchronizeTransform();continue}if(l.IsTouching()==0)continue;var q=e;q.GetType()!=m.b2_dynamicBody&&(q=f),i.Clear();var s=0,u=0;j[s+u++]=q,q.m_flags|=m.e_islandFlag;while(u>0){b=j[s++],--u,i.AddBody(b),b.IsAwake()==0&&b.SetAwake(!0);if(b.GetType()!=m.b2_dynamicBody)continue;for(g=b.m_contactList;g;g=g.next){if(i.m_contactCount==i.m_contactCapacity)break;if(g.contact.m_flags&b2Contact.e_islandFlag)continue;if(g.contact.IsSensor()==1||g.contact.IsEnabled()==0||g.contact.IsTouching()==0)continue;i.AddContact(g.contact),g.contact.m_flags|=b2Contact.e_islandFlag;var v=g.other;if(v.m_flags&m.e_islandFlag)continue;v.GetType()!=m.b2_staticBody&&(v.Advance(n),v.SetAwake(!0)),j[s+u]=v,++u,v.m_flags|=m.e_islandFlag}for(var w=b.m_jointList;w;w=w.next){if(i.m_jointCount==i.m_jointCapacity)continue;if(w.joint.m_islandFlag==1)continue;v=w.other;if(v.IsActive()==0)continue;i.AddJoint(w.joint),w.joint.m_islandFlag=!0;if(v.m_flags&m.e_islandFlag)continue;v.GetType()!=m.b2_staticBody&&(v.Advance(n),v.SetAwake(!0)),j[s+u]=v,++u,v.m_flags|=m.e_islandFlag}}var x=t.s_timestep;x.warmStarting=!1,x.dt=(1-n)*a.dt,x.inv_dt=1/x.dt,x.dtRatio=0,x.velocityIterations=a.velocityIterations,x.positionIterations=a.positionIterations,i.SolveTOI(x);var y=0;for(y=0;y<i.m_bodyCount;++y){b=i.m_bodies[y],b.m_flags&=~m.e_islandFlag;if(b.IsAwake()==0)continue;if(b.GetType()!=m.b2_dynamicBody)continue;b.SynchronizeFixtures();for(g=b.m_contactList;g;g=g.next)g.contact.m_flags&=~b2Contact.e_toiFlag}for(y=0;y<i.m_contactCount;++y)k=i.m_contacts[y],k.m_flags&=~(b2Contact.e_toiFlag|b2Contact.e_islandFlag);for(y=0;y<i.m_jointCount;++y)h=i.m_joints[y],h.m_islandFlag=!1;this.m_contactManager.FindNewContacts()}},t.prototype.DrawJoint=function(a){var b=a.GetBodyA(),c=a.GetBodyB(),d=b.m_xf,e=c.m_xf,f=d.position,g=e.position,h=a.GetAnchorA(),i=a.GetAnchorB(),j=t.s_jointColor;switch(a.m_type){case b2Joint.e_distanceJoint:this.m_debugDraw.DrawSegment(h,i,j);break;case b2Joint.e_pulleyJoint:var k=a,l=k.GetGroundAnchorA(),m=k.GetGroundAnchorB();this.m_debugDraw.DrawSegment(l,h,j),this.m_debugDraw.DrawSegment(m,i,j),this.m_debugDraw.DrawSegment(l,m,j);break;case b2Joint.e_mouseJoint:this.m_debugDraw.DrawSegment(h,i,j);break;default:b!=this.m_groundBody&&this.m_debugDraw.DrawSegment(f,h,j),this.m_debugDraw.DrawSegment(h,i,j),c!=this.m_groundBody&&this.m_debugDraw.DrawSegment(g,i,j)}},t.prototype.DrawShape=function(a,b,c){switch(a.m_type){case b2Shape.e_circleShape:var d=a,e=s.MulX(b,d.m_p),f=d.m_radius,g=b.R.col1;this.m_debugDraw.DrawSolidCircle(e,f,g,c);break;case b2Shape.e_polygonShape:var h=0,i=a,j=i.GetVertexCount(),k=i.GetVertices(),l=new Array(j);for(h=0;h<j;++h)l[h]=s.MulX(b,k[h]);this.m_debugDraw.DrawSolidPolygon(l,j,c);break;case b2Shape.e_edgeShape:var m=a;this.m_debugDraw.DrawSegment(s.MulX(b,m.GetVertex1()),s.MulX(b,m.GetVertex2()),c)}},t.prototype.SetDestructionListener=function(a){this.m_destructionListener=a},t.prototype.SetContactFilter=function(a){this.m_contactManager.m_contactFilter=a},t.prototype.SetContactListener=function(a){this.m_contactManager.m_contactListener=a},t.prototype.SetDebugDraw=function(a){this.m_debugDraw=a},t.prototype.SetBroadPhase=function(a){var b=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=a;for(var c=this.m_bodyList;c;c=c.m_next)for(var d=c.m_fixtureList;d;d=d.m_next)d.m_proxy=a.CreateProxy(b.GetFatAABB(d.m_proxy),d)},t.prototype.Validate=function(){this.m_contactManager.m_broadPhase.Validate()},t.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},t.prototype.CreateBody=function(a){if(this.IsLocked()==1)return null;var b=new m(a,this);return b.m_prev=null,b.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=b),this.m_bodyList=b,++this.m_bodyCount,b},t.prototype.DestroyBody=function(a){if(this.IsLocked()==1)return;var b=a.m_jointList;while(b){var c=b;b=b.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(c.joint),this.DestroyJoint(c.joint)}var d=a.m_controllerList;while(d){var e=d;d=d.nextController,e.controller.RemoveBody(a)}var f=a.m_contactList;while(f){var g=f;f=f.next,this.m_contactManager.Destroy(g.contact)}a.m_contactList=null;var h=a.m_fixtureList;while(h){var i=h;h=h.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(i),i.DestroyProxy(this.m_contactManager.m_broadPhase),i.Destroy()}a.m_fixtureList=null,a.m_fixtureCount=0,a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_bodyList&&(this.m_bodyList=a.m_next),--this.m_bodyCount},t.prototype.CreateJoint=function(a){var b=b2Joint.Create(a,null);b.m_prev=null,b.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=b),this.m_jointList=b,++this.m_jointCount,b.m_edgeA.joint=b,b.m_edgeA.other=b.m_bodyB,b.m_edgeA.prev=null,b.m_edgeA.next=b.m_bodyA.m_jointList,b.m_bodyA.m_jointList&&(b.m_bodyA.m_jointList.prev=b.m_edgeA),b.m_bodyA.m_jointList=b.m_edgeA,b.m_edgeB.joint=b,b.m_edgeB.other=b.m_bodyA,b.m_edgeB.prev=null,b.m_edgeB.next=b.m_bodyB.m_jointList,b.m_bodyB.m_jointList&&(b.m_bodyB.m_jointList.prev=b.m_edgeB),b.m_bodyB.m_jointList=b.m_edgeB;var c=a.bodyA,d=a.bodyB;if(a.collideConnected==0){var e=d.GetContactList();while(e)e.other==c&&e.contact.FlagForFiltering(),e=e.next}return b},t.prototype.DestroyJoint=function(a){var b=a.m_collideConnected;a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_jointList&&(this.m_jointList=a.m_next);var c=a.m_bodyA,d=a.m_bodyB;c.SetAwake(!0),d.SetAwake(!0),a.m_edgeA.prev&&(a.m_edgeA.prev.next=a.m_edgeA.next),a.m_edgeA.next&&(a.m_edgeA.next.prev=a.m_edgeA.prev),a.m_edgeA==c.m_jointList&&(c.m_jointList=a.m_edgeA.next),a.m_edgeA.prev=null,a.m_edgeA.next=null,a.m_edgeB.prev&&(a.m_edgeB.prev.next=a.m_edgeB.next),a.m_edgeB.next&&(a.m_edgeB.next.prev=a.m_edgeB.prev),a.m_edgeB==d.m_jointList&&(d.m_jointList=a.m_edgeB.next),a.m_edgeB.prev=null,a.m_edgeB.next=null,b2Joint.Destroy(a,null),--this.m_jointCount;if(b==0){var e=d.GetContactList();while(e)e.other==c&&e.contact.FlagForFiltering(),e=e.next}},t.prototype.AddController=function(a){return a.m_next=this.m_controllerList,a.m_prev=null,this.m_controllerList=a,a.m_world=this,this.m_controllerCount++,a},t.prototype.RemoveController=function(a){a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),this.m_controllerList==a&&(this.m_controllerList=a.m_next),this.m_controllerCount--},t.prototype.CreateController=function(a){if(a.m_world!=this)throw new Error("Controller can only be a member of one world");return a.m_next=this.m_controllerList,a.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=a),this.m_controllerList=a,++this.m_controllerCount,a.m_world=this,a},t.prototype.DestroyController=function(a){a.Clear(),a.m_next&&(a.m_next.m_prev=a.m_prev),a.m_prev&&(a.m_prev.m_next=a.m_next),a==this.m_controllerList&&(this.m_controllerList=a.m_next),--this.m_controllerCount},t.prototype.SetWarmStarting=function(a){t.m_warmStarting=a},t.prototype.SetContinuousPhysics=function(a){t.m_continuousPhysics=a},t.prototype.GetBodyCount=function(){return this.m_bodyCount},t.prototype.GetJointCount=function(){return this.m_jointCount},t.prototype.GetContactCount=function(){return this.m_contactCount},t.prototype.SetGravity=function(a){this.m_gravity=a},t.prototype.GetGravity=function(){return this.m_gravity},t.prototype.GetGroundBody=function(){return this.m_groundBody},t.prototype.Step=function(a,b,c){this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture),this.m_flags|=t.e_locked;var d=t.s_timestep2;d.dt=a,d.velocityIterations=b,d.positionIterations=c,a>0?d.inv_dt=1/a:d.inv_dt=0,d.dtRatio=this.m_inv_dt0*a,d.warmStarting=t.m_warmStarting,this.m_contactManager.Collide(),d.dt>0&&this.Solve(d),t.m_continuousPhysics&&d.dt>0&&this.SolveTOI(d),d.dt>0&&(this.m_inv_dt0=d.inv_dt),this.m_flags&=~t.e_locked},t.prototype.ClearForces=function(){for(var a=this.m_bodyList;a;a=a.m_next)a.m_force.SetZero(),a.m_torque=0},t.prototype.DrawDebugData=function(){if(this.m_debugDraw==null)return;this.m_debugDraw.Clear();var a=this.m_debugDraw.GetFlags(),b=0,c,d,e,f,g,h=new n,i=new n,j=new n,k,p=new o,q=new o,r=[new n,new n,new n,new n],s=new l(0,0,0);if(a&b2DebugDraw.e_shapeBit)for(c=this.m_bodyList;c;c=c.m_next){k=c.m_xf;for(d=c.GetFixtureList();d;d=d.m_next)e=d.GetShape(),c.IsActive()==0?(s.Set(.5,.5,.3),this.DrawShape(e,k,s)):c.GetType()==m.b2_staticBody?(s.Set(.5,.9,.5),this.DrawShape(e,k,s)):c.GetType()==m.b2_kinematicBody?(s.Set(.5,.5,.9),this.DrawShape(e,k,s)):c.IsAwake()==0?(s.Set(.6,.6,.6),this.DrawShape(e,k,s)):(s.Set(.9,.7,.7),this.DrawShape(e,k,s))}if(a&b2DebugDraw.e_jointBit)for(f=this.m_jointList;f;f=f.m_next)this.DrawJoint(f);if(a&b2DebugDraw.e_controllerBit)for(var u=this.m_controllerList;u;u=u.m_next)u.Draw(this.m_debugDraw);if(a&b2DebugDraw.e_pairBit){s.Set(.3,.9,.9);for(var v=this.m_contactManager.m_contactList;v;v=v.GetNext()){var w=v.GetFixtureA(),x=v.GetFixtureB(),y=w.GetAABB().GetCenter(),z=x.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(y,z,s)}}if(a&b2DebugDraw.e_aabbBit){g=this.m_contactManager.m_broadPhase,r=[new n,new n,new n,new n];for(c=this.m_bodyList;c;c=c.GetNext()){if(c.IsActive()==0)continue;for(d=c.GetFixtureList();d;d=d.GetNext()){var A=g.GetFatAABB(d.m_proxy);r[0].Set(A.lowerBound.x,A.lowerBound.y),r[1].Set(A.upperBound.x,A.lowerBound.y),r[2].Set(A.upperBound.x,A.upperBound.y),r[3].Set(A.lowerBound.x,A.upperBound.y),this.m_debugDraw.DrawPolygon(r,4,s)}}}if(a&b2DebugDraw.e_centerOfMassBit)for(c=this.m_bodyList;c;c=c.m_next)k=t.s_xf,k.R=c.m_xf.R,k.position=c.GetWorldCenter(),this.m_debugDraw.DrawTransform(k)},t.prototype.QueryAABB=function(a,b){function d(b){return a(c.GetUserData(b))}var c=this.m_contactManager.m_broadPhase;c.Query(d,b)},t.prototype.QueryShape=function(a,b,c){function e(e){var f=d.GetUserData(e);return b2Shape.TestOverlap(b,c,f.GetShape(),f.GetBody().GetTransform())?a(f):!0}c==null&&(c=new k,c.SetIdentity());var d=this.m_contactManager.m_broadPhase,f=new o;b.ComputeAABB(f,c),d.Query(e,f)},t.prototype.QueryPoint=function(a,b){function d(d){var e=c.GetUserData(d);return e.TestPoint(b)?a(e):!0}var c=this.m_contactManager.m_broadPhase,e=new o;e.lowerBound.Set(b.x-r.b2_linearSlop,b.y-r.b2_linearSlop),e.upperBound.Set(b.x+r.b2_linearSlop,b.y+r.b2_linearSlop),c.Query(d,e)},t.prototype.RayCast=function(a,b,c){function f(f,g){var h=d.GetUserData(g),i=h,j=i.RayCast(e,f);if(j){var k=e.fraction,l=new n((1-k)*b.x+k*c.x,(1-k)*b.y+k*c.y);return a(i,l,e.normal,k)}return f.maxFraction}var d=this.m_contactManager.m_broadPhase,e=new p,g=new q(b,c);d.RayCast(f,g)},t.prototype.RayCastOne=function(a,b){function d(a,b,d,e){return c=a,e}var c;return this.RayCast(d,a,b),c},t.prototype.RayCastAll=function(a,b){function d(a,b,d,e){return c[c.length]=a,1}var c=new Array;return this.RayCast(d,a,b),c},t.prototype.GetBodyList=function(){return this.m_bodyList},t.prototype.GetJointList=function(){return this.m_jointList},t.prototype.GetContactList=function(){return this.m_contactList},t.prototype.IsLocked=function(){return(this.m_flags&t.e_locked)>0},t.prototype.s_stack=new Array,t.prototype.m_flags=0,t.prototype.m_contactManager=new f,t.prototype.m_contactSolver=new g,t.prototype.m_island=new h,t.prototype.m_bodyList=null,t.prototype.m_jointList=null,t.prototype.m_contactList=null,t.prototype.m_bodyCount=0,t.prototype.m_contactCount=0,t.prototype.m_jointCount=0,t.prototype.m_controllerList=null,t.prototype.m_controllerCount=0,t.prototype.m_gravity=null,t.prototype.m_allowSleep=null,t.prototype.m_groundBody=null,t.prototype.m_destructionListener=null,t.prototype.m_debugDraw=null,t.prototype.m_inv_dt0=null,t.prototype.solve=t.prototype.Solve,t.prototype.solveTOI=t.prototype.SolveTOI,t.prototype.drawJoint=t.prototype.DrawJoint,t.prototype.drawShape=t.prototype.DrawShape,t.prototype.setDestructionListener=t.prototype.SetDestructionListener,t.prototype.setContactFilter=t.prototype.SetContactFilter,t.prototype.setContactListener=t.prototype.SetContactListener,t.prototype.setDebugDraw=t.prototype.SetDebugDraw,t.prototype.setBroadPhase=t.prototype.SetBroadPhase,t.prototype.validate=t.prototype.Validate,t.prototype.getProxyCount=t.prototype.GetProxyCount,t.prototype.createBody=t.prototype.CreateBody,t.prototype.destroyBody=t.prototype.DestroyBody,t.prototype.createJoint=t.prototype.CreateJoint,t.prototype.destroyJoint=t.prototype.DestroyJoint,t.prototype.addController=t.prototype.AddController,t.prototype.removeController=t.prototype.RemoveController,t.prototype.createController=t.prototype.CreateController,t.prototype.destroyController=t.prototype.DestroyController,t.prototype.setWarmStarting=t.prototype.SetWarmStarting,t.prototype.setContinuousPhysics=t.prototype.SetContinuousPhysics,t.prototype.getBodyCount=t.prototype.GetBodyCount,t.prototype.getJointCount=t.prototype.GetJointCount,t.prototype.getContactCount=t.prototype.GetContactCount,t.prototype.setGravity=t.prototype.SetGravity,t.prototype.getGravity=t.prototype.GetGravity,t.prototype.getGroundBody=t.prototype.GetGroundBody,t.prototype.step=t.prototype.Step,t.prototype.clearForces=t.prototype.ClearForces,t.prototype.drawDebugData=t.prototype.DrawDebugData,t.prototype.queryAABB=t.prototype.QueryAABB,t.prototype.queryShape=t.prototype.QueryShape,t.prototype.queryPoint=t.prototype.QueryPoint,t.prototype.rayCast=t.prototype.RayCast,t.prototype.rayCastOne=t.prototype.RayCastOne,t.prototype.rayCastAll=t.prototype.RayCastAll,t.prototype.getBodyList=t.prototype.GetBodyList,t.prototype.getJointList=t.prototype.GetJointList,t.prototype.getContactList=t.prototype.GetContactList,t.prototype.isLocked=t.prototype.IsLocked,b.exports=t},f:function(a,b,c,d){var e=a("g"),f=a("i"),g=a("n"),h=function(){this.__varz(),this.__constructor.apply(this,arguments)};h.prototype.__constructor=function(){this.m_world=null,this.m_contactCount=0,this.m_contactFilter=b2ContactFilter.b2_defaultFilter,this.m_contactListener=b2ContactListener.b2_defaultListener,this.m_contactFactory=new e(this.m_allocator),this.m_broadPhase=new f},h.prototype.__varz=function(){},h.s_evalCP=new g,h.prototype.AddPair=function(a,b){var c=a,d=b,e=c.GetBody(),f=d.GetBody();if(e==f)return;var g=f.GetContactList();while(g){if(g.other==e){var h=g.contact.GetFixtureA(),i=g.contact.GetFixtureB();if(h==c&&i==d)return;if(h==d&&i==c)return}g=g.next}if(f.ShouldCollide(e)==0)return;if(this.m_contactFilter.ShouldCollide(c,d)==0)return;var j=this.m_contactFactory.Create(c,d);c=j.GetFixtureA(),d=j.GetFixtureB(),e=c.m_body,f=d.m_body,j.m_prev=null,j.m_next=this.m_world.m_contactList,this.m_world.m_contactList!=null&&(this.m_world.m_contactList.m_prev=j),this.m_world.m_contactList=j,j.m_nodeA.contact=j,j.m_nodeA.other=f,j.m_nodeA.prev=null,j.m_nodeA.next=e.m_contactList,e.m_contactList!=null&&(e.m_contactList.prev=j.m_nodeA),e.m_contactList=j.m_nodeA,j.m_nodeB.contact=j,j.m_nodeB.other=e,j.m_nodeB.prev=null,j.m_nodeB.next=f.m_contactList,f.m_contactList!=null&&(f.m_contactList.prev=j.m_nodeB),f.m_contactList=j.m_nodeB,++this.m_world.m_contactCount;return},h.prototype.FindNewContacts=function(){var a=this;this.m_broadPhase.UpdatePairs(function(b,c){return a.AddPair(b,c)})},h.prototype.Destroy=function(a){var b=a.GetFixtureA(),c=a.GetFixtureB(),d=b.GetBody(),e=c.GetBody();a.IsTouching()&&this.m_contactListener.EndContact(a),a.m_prev&&(a.m_prev.m_next=a.m_next),a.m_next&&(a.m_next.m_prev=a.m_prev),a==this.m_world.m_contactList&&(this.m_world.m_contactList=a.m_next),a.m_nodeA.prev&&(a.m_nodeA.prev.next=a.m_nodeA.next),a.m_nodeA.next&&(a.m_nodeA.next.prev=a.m_nodeA.prev),a.m_nodeA==d.m_contactList&&(d.m_contactList=a.m_nodeA.next),a.m_nodeB.prev&&(a.m_nodeB.prev.next=a.m_nodeB.next),a.m_nodeB.next&&(a.m_nodeB.next.prev=a.m_nodeB.prev),a.m_nodeB==e.m_contactList&&(e.m_contactList=a.m_nodeB.next),this.m_contactFactory.Destroy(a),--this.m_contactCount},h.prototype.Collide=function(){var a=this.m_world.m_contactList;while(a){var b=a.GetFixtureA(),c=a.GetFixtureB(),d=b.GetBody(),e=c.GetBody();if(d.IsAwake()==0&&e.IsAwake()==0){a=a.GetNext();continue}if(a.m_flags&b2Contact.e_filterFlag){if(e.ShouldCollide(d)==0){var f=a;a=f.GetNext(),this.Destroy(f);continue}if(this.m_contactFilter.ShouldCollide(b,c)==0){f=a,a=f.GetNext(),this.Destroy(f);continue}a.m_flags&=~b2Contact.e_filterFlag}var g=b.m_proxy,h=c.m_proxy,i=this.m_broadPhase.TestOverlap(g,h);if(i==0){f=a,a=f.GetNext(),this.Destroy(f);continue}a.Update(this.m_contactListener),a=a.GetNext()}},h.prototype.m_world=null,h.prototype.m_broadPhase=null,h.prototype.m_contactList=null,h.prototype.m_contactCount=0,h.prototype.m_contactFilter=null,h.prototype.m_contactListener=null,h.prototype.m_contactFactory=null,h.prototype.m_allocator=null,h.prototype.addPair=h.prototype.AddPair,h.prototype.findNewContacts=h.prototype.FindNewContacts,h.prototype.destroy=h.prototype.Destroy,h.prototype.collide=h.prototype.Collide,b.exports=h},g:function(a,b,c,d){var e=a("h"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(a){this.m_allocator=a,this.InitializeRegisters()},f.prototype.__varz=function(){},f.prototype.AddType=function(a,b,c,d){this.m_registers[c][d].createFcn=a,this.m_registers[c][d].destroyFcn=b,this.m_registers[c][d].primary=!0,c!=d&&(this.m_registers[d][c].createFcn=a,this.m_registers[d][c].destroyFcn=b,this.m_registers[d][c].primary=!1)},f.prototype.InitializeRegisters=function(){this.m_registers=new Array(b2Shape.e_shapeTypeCount);for(var a=0;a<b2Shape.e_shapeTypeCount;a++){this.m_registers[a]=new Array(b2Shape.e_shapeTypeCount);for(var b=0;b<b2Shape.e_shapeTypeCount;b++)this.m_registers[a][b]=new e}this.AddType(b2CircleContact.Create,b2CircleContact.Destroy,b2Shape.e_circleShape,b2Shape.e_circleShape),this.AddType(b2PolyAndCircleContact.Create,b2PolyAndCircleContact.Destroy,b2Shape.e_polygonShape,b2Shape.e_circleShape),this.AddType(b2PolygonContact.Create,b2PolygonContact.Destroy,b2Shape.e_polygonShape,b2Shape.e_polygonShape),this.AddType(b2EdgeAndCircleContact.Create,b2EdgeAndCircleContact.Destroy,b2Shape.e_edgeShape,b2Shape.e_circleShape),this.AddType(b2PolyAndEdgeContact.Create,b2PolyAndEdgeContact.Destroy,b2Shape.e_polygonShape,b2Shape.e_edgeShape)},f.prototype.Create=function(a,b){var c=a.GetType(),d=b.GetType(),e=this.m_registers[c][d],f;if(e.pool)return f=e.pool,e.pool=f.m_next,e.poolCount--,f.Reset(a,b),f;var g=e.createFcn;return g!=null?e.primary?(f=g(this.m_allocator),f.Reset(a,b),f):(f=g(this.m_allocator),f.Reset(b,a),f):null},f.prototype.Destroy=function(a){a.m_manifold.m_pointCount>0&&(a.m_fixtureA.m_body.SetAwake(!0),a.m_fixtureB.m_body.SetAwake(!0));var b=a.m_fixtureA.GetType(),c=a.m_fixtureB.GetType(),d=this.m_registers[b][c];d.poolCount++,a.m_next=d.pool,d.pool=a;var e=d.destroyFcn;e(a,this.m_allocator)},f.prototype.m_registers=null,f.prototype.m_allocator=null,f.prototype.addType=f.prototype.AddType,f.prototype.initializeRegisters=f.prototype.InitializeRegisters,f.prototype.create=f.prototype.Create,f.prototype.destroy=f.prototype.Destroy,b.exports=f},h:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){},e.prototype.__varz=function(){},e.prototype.createFcn=null,e.prototype.destroyFcn=null,e.prototype.primary=null,e.prototype.pool=null,e.prototype.poolCount=0,b.exports=e},i:function(a,b,c,d){var e=a("j"),f=a("m"),g=function(){this.__varz(),this.__constructor.apply(this,arguments)};g.prototype.__constructor=function(){},g.prototype.__varz=function(){this.m_tree=new e,this.m_moveBuffer=new Array,this.m_pairBuffer=new Array},g.prototype.BufferMove=function(a){this.m_moveBuffer[this.m_moveBuffer.length]=a},g.prototype.UnBufferMove=function(a){var b=this.m_moveBuffer.indexOf(a);this.m_moveBuffer.splice(b,1)},g.prototype.ComparePairs=function(a,b){return 0},g.prototype.CreateProxy=function(a,b){var c=this.m_tree.CreateProxy(a,b);return++this.m_proxyCount,this.BufferMove(c),c},g.prototype.DestroyProxy=function(a){this.UnBufferMove(a),--this.m_proxyCount,this.m_tree.DestroyProxy(a)},g.prototype.MoveProxy=function(a,b,c){var d=this.m_tree.MoveProxy(a,b,c);d&&this.BufferMove(a)},g.prototype.TestOverlap=function(a,b){var c=this.m_tree.GetFatAABB(a),d=this.m_tree.GetFatAABB(b);return c.TestOverlap(d)},g.prototype.GetUserData=function(a){return this.m_tree.GetUserData(a)},g.prototype.GetFatAABB=function(a){return this.m_tree.GetFatAABB(a)},g.prototype.GetProxyCount=function(){return this.m_proxyCount},g.prototype.UpdatePairs=function(a){this.m_pairCount=0;for(var b=0,c=null;b<this.m_moveBuffer.length,c=this.m_moveBuffer[b];b++){var d=this;function e(a){if(a==c)return!0;d.m_pairCount==d.m_pairBuffer.length&&(d.m_pairBuffer[d.m_pairCount]=new f);var b=d.m_pairBuffer[d.m_pairCount];return b.proxyA=a<c?a:c,b.proxyB=a>=c?a:c,++d.m_pairCount,!0}var g=this.m_tree.GetFatAABB(c);this.m_tree.Query(e,g)}this.m_moveBuffer.length=0;for(var b=0;b<this.m_pairCount;){var h=this.m_pairBuffer[b],i=this.m_tree.GetUserData(h.proxyA),j=this.m_tree.GetUserData(h.proxyB);a(i,j),++b;while(b<this.m_pairCount){var k=this.m_pairBuffer[b];if(k.proxyA!=h.proxyA||k.proxyB!=h.proxyB)break;++b}}},g.prototype.Query=function(a,b){this.m_tree.Query(a,b)},g.prototype.RayCast=function(a,b){this.m_tree.RayCast(a,b)},g.prototype.Validate=function(){},g.prototype.Rebalance=function(a){this.m_tree.Rebalance(a)},g.prototype.m_tree=new e,g.prototype.m_proxyCount=0,g.prototype.m_moveBuffer=new Array,g.prototype.m_pairBuffer=new Array,g.prototype.m_pairCount=0,g.prototype.bufferMove=g.prototype.BufferMove,g.prototype.unBufferMove=g.prototype.UnBufferMove,g.prototype.comparePairs=g.prototype.ComparePairs,g.prototype.createProxy=g.prototype.CreateProxy,g.prototype.destroyProxy=g.prototype.DestroyProxy,g.prototype.moveProxy=g.prototype.MoveProxy,g.prototype.testOverlap=g.prototype.TestOverlap,g.prototype.getUserData=g.prototype.GetUserData,g.prototype.getFatAABB=g.prototype.GetFatAABB,g.prototype.getProxyCount=g.prototype.GetProxyCount,g.prototype.updatePairs=g.prototype.UpdatePairs,g.prototype.query=g.prototype.Query,g.prototype.rayCast=g.prototype.RayCast,g.prototype.validate=g.prototype.Validate,g.prototype.rebalance=g.prototype.Rebalance,b.exports=g},j:function(a,b,c,d){var e=a("k"),f=a("9"),g=a("l"),h=a("d"),i=a("2"),j=function(){this.__varz(),this.__constructor.apply(this,arguments)};j.prototype.__constructor=function(){this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0},j.prototype.__varz=function(){},j.prototype.AllocateNode=function(){if(this.m_freeList){var a=this.m_freeList;return this.m_freeList=a.parent,a.parent=null,a.child1=null,a.child2=null,a}return new e},j.prototype.FreeNode=function(a){a.parent=this.m_freeList,this.m_freeList=a},j.prototype.InsertLeaf=function(a){++this.m_insertionCount;if(this.m_root==null){this.m_root=a,this.m_root.parent=null;return}var b=a.aabb.GetCenter(),c=this.m_root;if(c.IsLeaf()==0)do{var d=c.child1,e=c.child2,f=Math.abs((d.aabb.lowerBound.x+d.aabb.upperBound.x)/2-b.x)+Math.abs((d.aabb.lowerBound.y+d.aabb.upperBound.y)/2-b.y),g=Math.abs((e.aabb.lowerBound.x+e.aabb.upperBound.x)/2-b.x)+Math.abs((e.aabb.lowerBound.y+e.aabb.upperBound.y)/2-b.y);f<g?c=d:c=e}while(c.IsLeaf()==0);var h=c.parent,i=this.AllocateNode();i.parent=h,i.userData=null,i.aabb.Combine(a.aabb,c.aabb);if(h){c.parent.child1==c?h.child1=i:h.child2=i,i.child1=c,i.child2=a,c.parent=i,a.parent=i;do{if(h.aabb.Contains(i.aabb))break;h.aabb.Combine(h.child1.aabb,h.child2.aabb),i=h,h=h.parent}while(h)}else i.child1=c,i.child2=a,c.parent=i,a.parent=i,this.m_root=i},j.prototype.RemoveLeaf=function(a){if(a==this.m_root){this.m_root=null;return}var b=a.parent,c=b.parent,d;b.child1==a?d=b.child2:d=b.child1;if(c){c.child1==b?c.child1=d:c.child2=d,d.parent=c,this.FreeNode(b);while(c){var e=c.aabb;c.aabb=f.Combine(c.child1.aabb,c.child2.aabb);if(e.Contains(c.aabb))break;c=c.parent}}else this.m_root=d,d.parent=null,this.FreeNode(b)},j.prototype.CreateProxy=function(a,b){var c=this.AllocateNode(),d=h.b2_aabbExtension,e=h.b2_aabbExtension;return c.aabb.lowerBound.x=a.lowerBound.x-d,c.aabb.lowerBound.y=a.lowerBound.y-e,c.aabb.upperBound.x=a.upperBound.x+d,c.aabb.upperBound.y=a.upperBound.y+e,c.userData=b,this.InsertLeaf(c),c},j.prototype.DestroyProxy=function(a){this.RemoveLeaf(a),this.FreeNode(a)},j.prototype.MoveProxy=function(a,b,c){h.b2Assert(a.IsLeaf());if(a.aabb.Contains(b))return!1;this.RemoveLeaf(a);var d=h.b2_aabbExtension+h.b2_aabbMultiplier*(c.x>0?c.x:-c.x),e=h.b2_aabbExtension+h.b2_aabbMultiplier*(c.y>0?c.y:-c.y);return a.aabb.lowerBound.x=b.lowerBound.x-d,a.aabb.lowerBound.y=b.lowerBound.y-e,a.aabb.upperBound.x=b.upperBound.x+d,a.aabb.upperBound.y=b.upperBound.y+e,this.InsertLeaf(a),!0},j.prototype.Rebalance=function(a){if(this.m_root==null)return;for(var b=0;b<a;b++){var c=this.m_root,d=0;while(c.IsLeaf()==0)c=this.m_path>>d&1?c.child2:c.child1,d=d+1&31;++this.m_path,this.RemoveLeaf(c),this.InsertLeaf(c)}},j.prototype.GetFatAABB=function(a){return a.aabb},j.prototype.GetUserData=function(a){return a.userData},j.prototype.Query=function(a,b){if(this.m_root==null)return;var c=new Array,d=0;c[d++]=this.m_root;while(d>0){var e=c[--d];if(e.aabb.TestOverlap(b))if(e.IsLeaf()){var f=a(e);if(!f)return}else c[d++]=e.child1,c[d++]=e.child2}},j.prototype.RayCast=function(a,b){if(this.m_root==null)return;var c=b.p1,d=b.p2,e=i.SubtractVV(c,d);e.Normalize();var h=i.CrossFV(1,e),j=i.AbsV(h),k=b.maxFraction,l=new f,m,n;m=c.x+k*(d.x-c.x),n=c.y+k*(d.y-c.y),l.lowerBound.x=Math.min(c.x,m),l.lowerBound.y=Math.min(c.y,n),l.upperBound.x=Math.max(c.x,m),l.upperBound.y=Math.max(c.y,n);var o=new Array,p=0;o[p++]=this.m_root;while(p>0){var q=o[--p];if(q.aabb.TestOverlap(l)==0)continue;var r=q.aabb.GetCenter(),s=q.aabb.GetExtents(),t=Math.abs(h.x*(c.x-r.x)+h.y*(c.y-r.y))-j.x*s.x-j.y*s.y;if(t>0)continue;if(q.IsLeaf()){var u=new g;u.p1=b.p1,u.p2=b.p2,u.maxFraction=b.maxFraction,k=a(u,q);if(k==0)return;m=c.x+k*(d.x-c.x),n=c.y+k*(d.y-c.y),l.lowerBound.x=Math.min(c.x,m),l.lowerBound.y=Math.min(c.y,n),l.upperBound.x=Math.max(c.x,m),l.upperBound.y=Math.max(c.y,n)}else o[p++]=q.child1,o[p++]=q.child2}},j.prototype.m_root=null,j.prototype.m_freeList=null,j.prototype.m_path=0,j.prototype.m_insertionCount=0,j.prototype.allocateNode=j.prototype.AllocateNode,j.prototype.freeNode=j.prototype.FreeNode,j.prototype.insertLeaf=j.prototype.InsertLeaf,j.prototype.removeLeaf=j.prototype.RemoveLeaf,j.prototype.createProxy=j.prototype.CreateProxy,j.prototype.destroyProxy=j.prototype.DestroyProxy,j.prototype.moveProxy=j.prototype.MoveProxy,j.prototype.rebalance=j.prototype.Rebalance,j.prototype.getFatAABB=j.prototype.GetFatAABB,j.prototype.getUserData=j.prototype.GetUserData,j.prototype.query=j.prototype.Query,j.prototype.rayCast=j.prototype.RayCast,b.exports=j},k:function(a,b,c,d){var e=a("9"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){},f.prototype.__varz=function(){this.aabb=new e},f.prototype.IsLeaf=function(){return this.child1==null},f.prototype.userData=null,f.prototype.aabb=new e,f.prototype.parent=null,f.prototype.child1=null,f.prototype.child2=null,f.prototype.isLeaf=f.prototype.IsLeaf,b.exports=f},l:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(a,b,c){a&&this.p1.SetV(a),b&&this.p2.SetV(b),c&&(this.maxFraction=c)},f.prototype.__varz=function(){this.p1=new e,this.p2=new e},f.prototype.p1=new e,f.prototype.p2=new e,f.prototype.maxFraction=null,b.exports=f},m:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){},e.prototype.__varz=function(){},e.prototype.proxyA=null,e.prototype.proxyB=null,b.exports=e},n:function(a,b,c,d){var e=a("1"),f=a("o"),g=function(){this.__varz(),this.__constructor.apply(this,arguments)};g.prototype.__constructor=function(){},g.prototype.__varz=function(){this.position=new e,this.velocity=new e,this.normal=new e,this.id=new f},g.prototype.shape1=null,g.prototype.shape2=null,g.prototype.position=new e,g.prototype.velocity=new e,g.prototype.normal=new e,g.prototype.separation=null,g.prototype.friction=null,g.prototype.restitution=null,g.prototype.id=new f,b.exports=g},o:function(a,b,c,d){var e=a("p"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){this.features._m_id=this},f.prototype.__varz=function(){this.features=new e},f.prototype.Set=function(a){key=a._key},f.prototype.Copy=function(){var a=new f;return a.key=key,a},f.prototype.__defineSetter__("key",function(){return this._key}),f.prototype.__defineSetter__("key",function(a){this._key=a,this.features._referenceEdge=this._key&255,this.features._incidentEdge=(this._key&65280)>>8&255,this.features._incidentVertex=(this._key&16711680)>>16&255,this.features._flip=(this._key&4278190080)>>24&255}),f.prototype._key=0,f.prototype.features=new e,f.prototype.set=f.prototype.Set,f.prototype.copy=f.prototype.Copy,b.exports=f},p:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){},e.prototype.__varz=function(){},e.prototype.__defineGetter__("referenceEdge",function(){return this._referenceEdge}),e.prototype.__defineSetter__("referenceEdge",function(a){this._referenceEdge=a,this._m_id._key=this._m_id._key&4294967040|this._referenceEdge&255}),e.prototype.__defineGetter__("incidentEdge",function(){return this._incidentEdge}),e.prototype.__defineSetter__("incidentEdge",function(a){this._incidentEdge=a,this._m_id._key=this._m_id._key&4294902015|this._incidentEdge<<8&65280}),e.prototype.__defineGetter__("incidentVertex",function(){return this._incidentVertex}),e.prototype.__defineSetter__("incidentVertex",function(a){this._incidentVertex=a,this._m_id._key=this._m_id._key&4278255615|this._incidentVertex<<16&16711680}),e.prototype.__defineGetter__("flip",function(){return this._flip}),e.prototype.__defineSetter__("flip",function(a){this._flip=a,this._m_id._key=this._m_id._key&16777215|this._flip<<24&4278190080}),e.prototype._referenceEdge=0,e.prototype._incidentEdge=0,e.prototype._incidentVertex=0,e.prototype._flip=0,e.prototype._m_id=null,b.exports=e},q:function(a,b,c,d){var e=a("r"),f=a("s"),g=a("t"),h=a("u"),i=a("d"),j=a("2"),k=function(){this.__varz(),this.__constructor.apply(this,arguments)};k.prototype.__constructor=function(){},k.prototype.__varz=function(){this.m_step=new e,this.m_constraints=new Array},k.s_worldManifold=new f,k.s_psm=new g,k.prototype.Initialize=function(a,b,c,d){var e;this.m_step.Set(a),this.m_allocator=d;var f=0,g,j;this.m_constraintCount=c;while(this.m_constraints.length<this.m_constraintCount)this.m_constraints[this.m_constraints.length]=new h;for(f=0;f<c;++f){e=b[f];var l=e.m_fixtureA,m=e.m_fixtureB,n=l.m_shape,o=m.m_shape,p=n.m_radius,q=o.m_radius,r=l.m_body,s=m.m_body,t=e.GetManifold(),u=i.b2MixFriction(l.GetFriction(),m.GetFriction()),v=i.b2MixRestitution(l.GetRestitution(),m.GetRestitution()),w=r.m_linearVelocity.x,x=r.m_linearVelocity.y,y=s.m_linearVelocity.x,z=s.m_linearVelocity.y,A=r.m_angularVelocity,B=s.m_angularVelocity;i.b2Assert(t.m_pointCount>0),k.s_worldManifold.Initialize(t,r.m_xf,p,s.m_xf,q);var C=k.s_worldManifold.m_normal.x,D=k.s_worldManifold.m_normal.y,E=this.m_constraints[f];E.bodyA=r,E.bodyB=s,E.manifold=t,E.normal.x=C,E.normal.y=D,E.pointCount=t.m_pointCount,E.friction=u,E.restitution=v,E.localPlaneNormal.x=t.m_localPlaneNormal.x,E.localPlaneNormal.y=t.m_localPlaneNormal.y,E.localPoint.x=t.m_localPoint.x,E.localPoint.y=t.m_localPoint.y,E.radius=p+q,E.type=t.m_type;for(var F=0;F<E.pointCount;++F){var G=t.m_points[F],H=E.points[F];H.normalImpulse=G.m_normalImpulse,H.tangentImpulse=G.m_tangentImpulse,H.localPoint.SetV(G.m_localPoint);var I=H.rA.x=k.s_worldManifold.m_points[F].x-r.m_sweep.c.x,J=H.rA.y=k.s_worldManifold.m_points[F].y-r.m_sweep.c.y,K=H.rB.x=k.s_worldManifold.m_points[F].x-s.m_sweep.c.x,L=H.rB.y=k.s_worldManifold.m_points[F].y-s.m_sweep.c.y,M=I*D-J*C,N=K*D-L*C;M*=M,N*=N;var O=r.m_invMass+s.m_invMass+r.m_invI*M+s.m_invI*N;H.normalMass=1/O;var P=r.m_mass*r.m_invMass+s.m_mass*s.m_invMass;P+=r.m_mass*r.m_invI*M+s.m_mass*s.m_invI*N,H.equalizedMass=1/P;var Q=D,R=-C,S=I*R-J*Q,T=K*R-L*Q;S*=S,T*=T;var U=r.m_invMass+s.m_invMass+r.m_invI*S+s.m_invI*T;H.tangentMass=1/U,H.velocityBias=0;var V=y+ -B*L-w- -A*J,W=z+B*K-x-A*I,X=E.normal.x*V+E.normal.y*W;X<-i.b2_velocityThreshold&&(H.velocityBias+=-E.restitution*X)}if(E.pointCount==2){var Y=E.points[0],Z=E.points[1],$=r.m_invMass,_=r.m_invI,ab=s.m_invMass,bb=s.m_invI,cb=Y.rA.x*D-Y.rA.y*C,db=Y.rB.x*D-Y.rB.y*C,eb=Z.rA.x*D-Z.rA.y*C,fb=Z.rB.x*D-Z.rB.y*C,gb=$+ab+_*cb*cb+bb*db*db,hb=$+ab+_*eb*eb+bb*fb*fb,ib=$+ab+_*cb*eb+bb*db*fb,jb=100;gb*gb<jb*(gb*hb-ib*ib)?(E.K.col1.Set(gb,ib),E.K.col2.Set(ib,hb),E.K.GetInverse(E.normalMass)):E.pointCount=1}}},k.prototype.InitVelocityConstraints=function(a){var b,c,d;for(var e=0;e<this.m_constraintCount;++e){var f=this.m_constraints[e],g=f.bodyA,h=f.bodyB,i=g.m_invMass,j=g.m_invI,k=h.m_invMass,l=h.m_invI,m=f.normal.x,n=f.normal.y,o=n,p=-m,q,r=0,s=0;if(a.warmStarting){s=f.pointCount;for(r=0;r<s;++r){var t=f.points[r];t.normalImpulse*=a.dtRatio,t.tangentImpulse*=a.dtRatio;var u=t.normalImpulse*m+t.tangentImpulse*o,v=t.normalImpulse*n+t.tangentImpulse*p;g.m_angularVelocity-=j*(t.rA.x*v-t.rA.y*u),g.m_linearVelocity.x-=i*u,g.m_linearVelocity.y-=i*v,h.m_angularVelocity+=l*(t.rB.x*v-t.rB.y*u),h.m_linearVelocity.x+=k*u,h.m_linearVelocity.y+=k*v}}else{s=f.pointCount;for(r=0;r<s;++r){var w=f.points[r];w.normalImpulse=0,w.tangentImpulse=0}}}},k.prototype.SolveVelocityConstraints=function(){var a=0,b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v,w,x;for(var y=0;y<this.m_constraintCount;++y){var z=this.m_constraints[y],A=z.bodyA,B=z.bodyB,C=A.m_angularVelocity,D=B.m_angularVelocity,E=A.m_linearVelocity,F=B.m_linearVelocity,G=A.m_invMass,H=A.m_invI,I=B.m_invMass,J=B.m_invI,K=z.normal.x,L=z.normal.y,M=L,N=-K,O=z.friction,P;for(a=0;a<z.pointCount;a++)b=z.points[a],g=F.x-D*b.rB.y-E.x+C*b.rA.y,h=F.y+D*b.rB.x-E.y-C*b.rA.x,k=g*M+h*N,l=b.tangentMass*-k,m=O*b.normalImpulse,n=j.Clamp(b.tangentImpulse+l,-m,m),l=n-b.tangentImpulse,o=l*M,p=l*N,E.x-=G*o,E.y-=G*p,C-=H*(b.rA.x*p-b.rA.y*o),F.x+=I*o,F.y+=I*p,D+=J*(b.rB.x*p-b.rB.y*o),b.tangentImpulse=n;var Q=z.pointCount;if(z.pointCount==1)b=z.points[0],g=F.x+ -D*b.rB.y-E.x- -C*b.rA.y,h=F.y+D*b.rB.x-E.y-C*b.rA.x,i=g*K+h*L,l=-b.normalMass*(i-b.velocityBias),n=b.normalImpulse+l,n=n>0?n:0,l=n-b.normalImpulse,o=l*K,p=l*L,E.x-=G*o,E.y-=G*p,C-=H*(b.rA.x*p-b.rA.y*o),F.x+=I*o,F.y+=I*p,D+=J*(b.rB.x*p-b.rB.y*o),b.normalImpulse=n;else{var R=z.points[0],S=z.points[1],T=R.normalImpulse,U=S.normalImpulse,V=F.x-D*R.rB.y-E.x+C*R.rA.y,W=F.y+D*R.rB.x-E.y-C*R.rA.x,X=F.x-D*S.rB.y-E.x+C*S.rA.y,Y=F.y+D*S.rB.x-E.y-C*S.rA.x,Z=V*K+W*L,$=X*K+Y*L,_=Z-R.velocityBias,ab=$-S.velocityBias;w=z.K,_-=w.col1.x*T+w.col2.x*U,ab-=w.col1.y*T+w.col2.y*U;var bb=.001;for(;;){w=z.normalMass;var cb=-(w.col1.x*_+w.col2.x*ab),db=-(w.col1.y*_+w.col2.y*ab);if(cb>=0&&db>=0){q=cb-T,r=db-U,s=q*K,t=q*L,u=r*K,v=r*L,E.x-=G*(s+u),E.y-=G*(t+v),C-=H*(R.rA.x*t-R.rA.y*s+S.rA.x*v-S.rA.y*u),F.x+=I*(s+u),F.y+=I*(t+v),D+=J*(R.rB.x*t-R.rB.y*s+S.rB.x*v-S.rB.y*u),R.normalImpulse=cb,S.normalImpulse=db;break}cb=-R.normalMass*_,db=0,Z=0,$=z.K.col1.y*cb+ab;if(cb>=0&&$>=0){q=cb-T,r=db-U,s=q*K,t=q*L,u=r*K,v=r*L,E.x-=G*(s+u),E.y-=G*(t+v),C-=H*(R.rA.x*t-R.rA.y*s+S.rA.x*v-S.rA.y*u),F.x+=I*(s+u),F.y+=I*(t+v),D+=J*(R.rB.x*t-R.rB.y*s+S.rB.x*v-S.rB.y*u),R.normalImpulse=cb,S.normalImpulse=db;break}cb=0,db=-S.normalMass*ab,Z=z.K.col2.x*db+_,$=0;if(db>=0&&Z>=0){q=cb-T,r=db-U,s=q*K,t=q*L,u=r*K,v=r*L,E.x-=G*(s+u),E.y-=G*(t+v),C-=H*(R.rA.x*t-R.rA.y*s+S.rA.x*v-S.rA.y*u),F.x+=I*(s+u),F.y+=I*(t+v),D+=J*(R.rB.x*t-R.rB.y*s+S.rB.x*v-S.rB.y*u),R.normalImpulse=cb,S.normalImpulse=db;break}cb=0,db=0,Z=_,$=ab;if(Z>=0&&$>=0){q=cb-T,r=db-U,s=q*K,t=q*L,u=r*K,v=r*L,E.x-=G*(s+u),E.y-=G*(t+v),C-=H*(R.rA.x*t-R.rA.y*s+S.rA.x*v-S.rA.y*u),F.x+=I*(s+u),F.y+=I*(t+v),D+=J*(R.rB.x*t-R.rB.y*s+S.rB.x*v-S.rB.y*u),R.normalImpulse=cb,S.normalImpulse=db;break}break}}A.m_angularVelocity=C,B.m_angularVelocity=D}},k.prototype.FinalizeVelocityConstraints=function(){for(var a=0;a<this.m_constraintCount;++a){var b=this.m_constraints[a],c=b.manifold;for(var d=0;d<b.pointCount;++d){var e=c.m_points[d],f=b.points[d];e.m_normalImpulse=f.normalImpulse,e.m_tangentImpulse=f.tangentImpulse}}},k.prototype.SolvePositionConstraints=function(a){var b=0;for(var c=0;c<this.m_constraintCount;c++){var d=this.m_constraints[c],e=d.bodyA,f=d.bodyB,g=e.m_mass*e.m_invMass,h=e.m_mass*e.m_invI,l=f.m_mass*f.m_invMass,m=f.m_mass*f.m_invI;k.s_psm.Initialize(d);var n=k.s_psm.m_normal;for(var o=0;o<d.pointCount;o++){var p=d.points[o],q=k.s_psm.m_points[o],r=k.s_psm.m_separations[o],s=q.x-e.m_sweep.c.x,t=q.y-e.m_sweep.c.y,u=q.x-f.m_sweep.c.x,v=q.y-f.m_sweep.c.y;b=b<r?b:r;var w=j.Clamp(a*(r+i.b2_linearSlop),-i.b2_maxLinearCorrection,0),x=-p.equalizedMass*w,y=x*n.x,z=x*n.y;e.m_sweep.c.x-=g*y,e.m_sweep.c.y-=g*z,e.m_sweep.a-=h*(s*z-t*y),e.SynchronizeTransform(),f.m_sweep.c.x+=l*y,f.m_sweep.c.y+=l*z,f.m_sweep.a+=m*(u*z-v*y),f.SynchronizeTransform()}}return b>-1.5*i.b2_linearSlop},k.prototype.m_step=new e,k.prototype.m_allocator=null,k.prototype.m_constraints=new Array,k.prototype.m_constraintCount=0,k.prototype.initialize=k.prototype.Initialize,k.prototype.initVelocityConstraints=k.prototype.InitVelocityConstraints,k.prototype.solveVelocityConstraints=k.prototype.SolveVelocityConstraints,k.prototype.finalizeVelocityConstraints=k.prototype.FinalizeVelocityConstraints,k.prototype.solvePositionConstraints=k.prototype.SolvePositionConstraints,b.exports=k},r:function(a,b,c,d){var e=function(){this.__varz(),this.__constructor.apply(this,arguments)};e.prototype.__constructor=function(){},e.prototype.__varz=function(){},e.prototype.Set=function(a){this.dt=a.dt,this.inv_dt=a.inv_dt,this.positionIterations=a.positionIterations,this.velocityIterations=a.velocityIterations,this.warmStarting=a.warmStarting},e.prototype.dt=null,e.prototype.inv_dt=null,e.prototype.dtRatio=null,e.prototype.velocityIterations=0,e.prototype.positionIterations=0,e.prototype.warmStarting=null,e.prototype.set=e.prototype.Set,b.exports=e},s:function(a,b,c,d){var e=a("1"),f=a("d"),g=function(){this.__varz(),this.__constructor.apply(this,arguments)};g.prototype.__constructor=function(){this.m_points=new Array(f.b2_maxManifoldPoints);for(var a=0;a<f.b2_maxManifoldPoints;a++)this.m_points[a]=new e},g.prototype.__varz=function(){this.m_normal=new e},g.prototype.Initialize=function(a,b,c,d,e){if(a.m_pointCount==0)return;var f=0,g,h,i,j,k,l,m,n;switch(a.m_type){case b2Manifold.e_circles:h=b.R,g=a.m_localPoint;var o=b.position.x+h.col1.x*g.x+h.col2.x*g.y,p=b.position.y+h.col1.y*g.x+h.col2.y*g.y;h=d.R,g=a.m_points[0].m_localPoint;var q=d.position.x+h.col1.x*g.x+h.col2.x*g.y,r=d.position.y+h.col1.y*g.x+h.col2.y*g.y,s=q-o,t=r-p,u=s*s+t*t;if(u>Number.MIN_VALUE*Number.MIN_VALUE){var v=Math.sqrt(u);this.m_normal.x=s/v,this.m_normal.y=t/v}else this.m_normal.x=1,this.m_normal.y=0;var w=o+c*this.m_normal.x,x=p+c*this.m_normal.y,y=q-e*this.m_normal.x,z=r-e*this.m_normal.y;this.m_points[0].x=.5*(w+y),this.m_points[0].y=.5*(x+z);break;case b2Manifold.e_faceA:h=b.R,g=a.m_localPlaneNormal,i=h.col1.x*g.x+h.col2.x*g.y,j=h.col1.y*g.x+h.col2.y*g.y,h=b.R,g=a.m_localPoint,k=b.position.x+h.col1.x*g.x+h.col2.x*g.y,l=b.position.y+h.col1.y*g.x+h.col2.y*g.y,this.m_normal.x=i,this.m_normal.y=j;for(f=0;f<a.m_pointCount;f++)h=d.R,g=a.m_points[f].m_localPoint,m=d.position.x+h.col1.x*g.x+h.col2.x*g.y,n=d.position.y+h.col1.y*g.x+h.col2.y*g.y,this.m_points[f].x=m+.5*(c-(m-k)*i-(n-l)*j-e)*i,this.m_points[f].y=n+.5*(c-(m-k)*i-(n-l)*j-e)*j;break;case b2Manifold.e_faceB:h=d.R,g=a.m_localPlaneNormal,i=h.col1.x*g.x+h.col2.x*g.y,j=h.col1.y*g.x+h.col2.y*g.y,h=d.R,g=a.m_localPoint,k=d.position.x+h.col1.x*g.x+h.col2.x*g.y,l=d.position.y+h.col1.y*g.x+h.col2.y*g.y,this.m_normal.x=-i,this.m_normal.y=-j;for(f=0;f<a.m_pointCount;f++)h=b.R,g=a.m_points[f].m_localPoint,m=b.position.x+h.col1.x*g.x+h.col2.x*g.y,n=b.position.y+h.col1.y*g.x+h.col2.y*g.y,this.m_points[f].x=m+.5*(e-(m-k)*i-(n-l)*j-c)*i,this.m_points[f].y=n+.5*(e-(m-k)*i-(n-l)*j-c)*j}},g.prototype.m_normal=new e,g.prototype.m_points=null,g.prototype.initialize=g.prototype.Initialize,b.exports=g},t:function(a,b,c,d){var e=a("1"),f=a("d"),g=function(){this.__varz(),this.__constructor.apply(this,arguments)};g.prototype.__constructor=function(){this.m_normal=new e,this.m_separations=new Array(f.b2_maxManifoldPoints),this.m_points=new Array(f.b2_maxManifoldPoints);for(var a=0;a<f.b2_maxManifoldPoints;a++)this.m_points[a]=new e},g.prototype.__varz=function(){},g.circlePointA=new e,g.circlePointB=new e,g.prototype.Initialize=function(a){f.b2Assert(a.pointCount>0);var b=0,c,d,e,g,h,i;switch(a.type){case b2Manifold.e_circles:e=a.bodyA.m_xf.R,g=a.localPoint;var j=a.bodyA.m_xf.position.x+(e.col1.x*g.x+e.col2.x*g.y),k=a.bodyA.m_xf.position.y+(e.col1.y*g.x+e.col2.y*g.y);e=a.bodyB.m_xf.R,g=a.points[0].localPoint;var l=a.bodyB.m_xf.position.x+(e.col1.x*g.x+e.col2.x*g.y),m=a.bodyB.m_xf.position.y+(e.col1.y*g.x+e.col2.y*g.y),n=l-j,o=m-k,p=n*n+o*o;if(p>Number.MIN_VALUE*Number.MIN_VALUE){var q=Math.sqrt(p);this.m_normal.x=n/q,this.m_normal.y=o/q}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(j+l),this.m_points[0].y=.5*(k+m),this.m_separations[0]=n*this.m_normal.x+o*this.m_normal.y-a.radius;break;case b2Manifold.e_faceA:e=a.bodyA.m_xf.R,g=a.localPlaneNormal,this.m_normal.x=e.col1.x*g.x+e.col2.x*g.y,this.m_normal.y=e.col1.y*g.x+e.col2.y*g.y,e=a.bodyA.m_xf.R,g=a.localPoint,h=a.bodyA.m_xf.position.x+(e.col1.x*g.x+e.col2.x*g.y),i=a.bodyA.m_xf.position.y+(e.col1.y*g.x+e.col2.y*g.y),e=a.bodyB.m_xf.R;for(b=0;b<a.pointCount;++b)g=a.points[b].localPoint,c=a.bodyB.m_xf.position.x+(e.col1.x*g.x+e.col2.x*g.y),d=a.bodyB.m_xf.position.y+(e.col1.y*g.x+e.col2.y*g.y),this.m_separations[b]=(c-h)*this.m_normal.x+(d-i)*this.m_normal.y-a.radius,this.m_points[b].x=c,this.m_points[b].y=d;break;case b2Manifold.e_faceB:e=a.bodyB.m_xf.R,g=a.localPlaneNormal,this.m_normal.x=e.col1.x*g.x+e.col2.x*g.y,this.m_normal.y=e.col1.y*g.x+e.col2.y*g.y,e=a.bodyB.m_xf.R,g=a.localPoint,h=a.bodyB.m_xf.position.x+(e.col1.x*g.x+e.col2.x*g.y),i=a.bodyB.m_xf.position.y+(e.col1.y*g.x+e.col2.y*g.y),e=a.bodyA.m_xf.R;for(b=0;b<a.pointCount;++b)g=a.points[b].localPoint,c=a.bodyA.m_xf.position.x+(e.col1.x*g.x+e.col2.x*g.y),d=a.bodyA.m_xf.position.y+(e.col1.y*g.x+e.col2.y*g.y),this.m_separations[b]=(c-h)*this.m_normal.x+(d-i)*this.m_normal.y-a.radius,this.m_points[b].Set(c,d);this.m_normal.x*=-1,this.m_normal.y*=-1}},g.prototype.m_normal=null,g.prototype.m_points=null,g.prototype.m_separations=null,g.prototype.initialize=g.prototype.Initialize,b.exports=g},u:function(a,b,c,d){var e=a("v"),f=a("1"),g=a("4"),h=a("d"),i=function(){this.__varz(),this.__constructor.apply(this,arguments)};i.prototype.__constructor=function(){this.points=new Array(h.b2_maxManifoldPoints);for(var a=0;a<h.b2_maxManifoldPoints;a++)this.points[a]=new e},i.prototype.__varz=function(){this.localPlaneNormal=new f,this.localPoint=new f,this.normal=new f,this.normalMass=new g,this.K=new g},i.prototype.points=null,i.prototype.localPlaneNormal=new f,i.prototype.localPoint=new f,i.prototype.normal=new f,i.prototype.normalMass=new g,i.prototype.K=new g,i.prototype.bodyA=null,i.prototype.bodyB=null,i.prototype.type=0,i.prototype.radius=null,i.prototype.friction=null,i.prototype.restitution=null,i.prototype.pointCount=0,i.prototype.manifold=null,b.exports=i},v:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){},f.prototype.__varz=function(){this.localPoint=new e,this.rA=new e,this.rB=new e},f.prototype.localPoint=new e,f.prototype.rA=new e,f.prototype.rB=new e,f.prototype.normalImpulse=null,f.prototype.tangentImpulse=null,f.prototype.normalMass=null,f.prototype.tangentMass=null,f.prototype.equalizedMass=null,f.prototype.velocityBias=null,b.exports=f},w:function(a,b,c,d){var e=a("x"),f=a("d"),g=a("2"),h=function(){this.__varz(),this.__constructor.apply(this,arguments)};h.prototype.__constructor=function(){this.m_bodies=new Array,this.m_contacts=new Array,this.m_joints=new Array},h.prototype.__varz=function(){},h.s_impulse=new e,h.prototype.Initialize=function(a,b,c,d,e,f){var g=0;this.m_bodyCapacity=a,this.m_contactCapacity=b,this.m_jointCapacity=c,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=d,this.m_listener=e,this.m_contactSolver=f;for(g=this.m_bodies.length;g<a;g++)this.m_bodies[g]=null;for(g=this.m_contacts.length;g<b;g++)this.m_contacts[g]=null;for(g=this.m_joints.length;g<c;g++)this.m_joints[g]=null},h.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},h.prototype.Solve=function(a,b,c){var d=0,e=0,h,i;for(d=0;d<this.m_bodyCount;++d){h=this.m_bodies[d];if(h.GetType()!=b2Body.b2_dynamicBody)continue;h.m_linearVelocity.x+=a.dt*(b.x+h.m_invMass*h.m_force.x),h.m_linearVelocity.y+=a.dt*(b.y+h.m_invMass*h.m_force.y),h.m_angularVelocity+=a.dt*h.m_invI*h.m_torque,h.m_linearVelocity.Multiply(g.Clamp(1-a.dt*h.m_linearDamping,0,1)),h.m_angularVelocity*=g.Clamp(1-a.dt*h.m_angularDamping,0,1)}this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);var j=this.m_contactSolver;j.InitVelocityConstraints(a);for(d=0;d<this.m_jointCount;++d)i=this.m_joints[d],i.InitVelocityConstraints(a);for(d=0;d<a.velocityIterations;++d){for(e=0;e<this.m_jointCount;++e)i=this.m_joints[e],i.SolveVelocityConstraints(a);j.SolveVelocityConstraints()}for(d=0;d<this.m_jointCount;++d)i=this.m_joints[d],i.FinalizeVelocityConstraints();j.FinalizeVelocityConstraints();for(d=0;d<this.m_bodyCount;++d){h=this.m_bodies[d];if(h.GetType()==b2Body.b2_staticBody)continue;var k=a.dt*h.m_linearVelocity.x,l=a.dt*h.m_linearVelocity.y;k*k+l*l>f.b2_maxTranslationSquared&&(h.m_linearVelocity.Normalize(),h.m_linearVelocity.x*=f.b2_maxTranslation*a.inv_dt,h.m_linearVelocity.y*=f.b2_maxTranslation*a.inv_dt);var m=a.dt*h.m_angularVelocity;m*m>f.b2_maxRotationSquared&&(h.m_angularVelocity<0?h.m_angularVelocity=-f.b2_maxRotation*a.inv_dt:h.m_angularVelocity=f.b2_maxRotation*a.inv_dt),h.m_sweep.c0.SetV(h.m_sweep.c),h.m_sweep.a0=h.m_sweep.a,h.m_sweep.c.x+=a.dt*h.m_linearVelocity.x,h.m_sweep.c.y+=a.dt*h.m_linearVelocity.y,h.m_sweep.a+=a.dt*h.m_angularVelocity,h.SynchronizeTransform()}for(d=0;d<a.positionIterations;++d){var n=j.SolvePositionConstraints(f.b2_contactBaumgarte),o=!0;for(e=0;e<this.m_jointCount;++e){i=this.m_joints[e];var p=i.SolvePositionConstraints(f.b2_contactBaumgarte);o=o&&p}if(n&&o)break}this.Report(j.m_constraints);if(c){var q=Number.MAX_VALUE,r=f.b2_linearSleepTolerance*f.b2_linearSleepTolerance,s=f.b2_angularSleepTolerance*f.b2_angularSleepTolerance;for(d=0;d<this.m_bodyCount;++d){h=this.m_bodies[d];if(h.GetType()==b2Body.b2_staticBody)continue;(h.m_flags&b2Body.e_allowSleepFlag)==0&&(h.m_sleepTime=0,q=0),(h.m_flags&b2Body.e_allowSleepFlag)==0||h.m_angularVelocity*h.m_angularVelocity>s||g.Dot(h.m_linearVelocity,h.m_linearVelocity)>r?(h.m_sleepTime=0,q=0):(h.m_sleepTime+=a.dt,q=g.Min(q,h.m_sleepTime))}if(q>=f.b2_timeToSleep)for(d=0;d<this.m_bodyCount;++d)h=this.m_bodies[d],h.SetAwake(!1)}},h.prototype.SolveTOI=function(a){var b=0,c=0;this.m_contactSolver.Initialize(a,this.m_contacts,this.m_contactCount,this.m_allocator);var d=this.m_contactSolver;for(b=0;b<this.m_jointCount;++b)this.m_joints[b].InitVelocityConstraints(a);for(b=0;b<a.velocityIterations;++b){d.SolveVelocityConstraints();for(c=0;c<this.m_jointCount;++c)this.m_joints[c].SolveVelocityConstraints(a)}for(b=0;b<this.m_bodyCount;++b){var e=this.m_bodies[b];if(e.GetType()==b2Body.b2_staticBody)continue;var g=a.dt*e.m_linearVelocity.x,h=a.dt*e.m_linearVelocity.y;g*g+h*h>f.b2_maxTranslationSquared&&(e.m_linearVelocity.Normalize(),e.m_linearVelocity.x*=f.b2_maxTranslation*a.inv_dt,e.m_linearVelocity.y*=f.b2_maxTranslation*a.inv_dt);var i=a.dt*e.m_angularVelocity;i*i>f.b2_maxRotationSquared&&(e.m_angularVelocity<0?e.m_angularVelocity=-f.b2_maxRotation*a.inv_dt:e.m_angularVelocity=f.b2_maxRotation*a.inv_dt),e.m_sweep.c0.SetV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=a.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=a.dt*e.m_linearVelocity.y,e.m_sweep.a+=a.dt*e.m_angularVelocity,e.SynchronizeTransform()}var j=.75;for(b=0;b<a.positionIterations;++b){var k=d.SolvePositionConstraints(j),l=!0;for(c=0;c<this.m_jointCount;++c){var m=this.m_joints[c].SolvePositionConstraints(f.b2_contactBaumgarte);l=l&&m}if(k&&l)break}this.Report(d.m_constraints)},h.prototype.Report=function(a){if(this.m_listener==null)return;for(var b=0;b<this.m_contactCount;++b){var c=this.m_contacts[b],d=a[b];for(var e=0;e<d.pointCount;++e)h.s_impulse.normalImpulses[e]=d.points[e].normalImpulse,h.s_impulse.tangentImpulses[e]=d.points[e].tangentImpulse;this.m_listener.PostSolve(c,h.s_impulse)}},h.prototype.AddBody=function(a){a.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=a},h.prototype.AddContact=function(a){this.m_contacts[this.m_contactCount++]=a},h.prototype.AddJoint=function(a){this.m_joints[this.m_jointCount++]=a},h.prototype.m_allocator=null,h.prototype.m_listener=null,h.prototype.m_contactSolver=null,h.prototype.m_bodies=null,h.prototype.m_contacts=null,h.prototype.m_joints=null,h.prototype.m_bodyCount=0,h.prototype.m_jointCount=0,h.prototype.m_contactCount=0,h.prototype.m_bodyCapacity=0,h.prototype.m_contactCapacity=0,h.prototype.m_jointCapacity=0,h.prototype.initialize=h.prototype.Initialize,h.prototype.clear=h.prototype.Clear,h.prototype.solve=h.prototype.Solve,h.prototype.solveTOI=h.prototype.SolveTOI,h.prototype.report=h.prototype.Report,h.prototype.addBody=h.prototype.AddBody,h.prototype.addContact=h.prototype.AddContact,h.prototype.addJoint=h.prototype.AddJoint,b.exports=h},x:function(a,b,c,d){var e=a("d"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){},f.prototype.__varz=function(){this.normalImpulses=new Array(e.b2_maxManifoldPoints),this.tangentImpulses=new Array(e.b2_maxManifoldPoints)},f.prototype.normalImpulses=new Array(e.b2_maxManifoldPoints),f.prototype.tangentImpulses=new Array(e.b2_maxManifoldPoints),b.exports=f},y:function(a,b,c,d){var e=a("2"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(a,b,c){this._r=parseInt(255*e.Clamp(a,0,1)),this._g=parseInt(255*e.Clamp(b,0,1)),this._b=parseInt(255*e.Clamp(c,0,1))},f.prototype.__varz=function(){},f.prototype.Set=function(a,b,c){this._r=parseInt(255*e.Clamp(a,0,1)),this._g=parseInt(255*e.Clamp(b,0,1)),this._b=parseInt(255*e.Clamp(c,0,1))},f.prototype.__defineGetter__("r",function(){return this._r}),f.prototype.__defineSetter__("r",function(a){this._r=parseInt(255*e.Clamp(a,0,1))}),f.prototype.__defineGetter__("g",function(){return this._g}),f.prototype.__defineSetter__("g",function(a){this._g=parseInt(255*e.Clamp(a,0,1))}),f.prototype.__defineGetter__("b",function(){return this._b}),f.prototype.__defineSetter__("b",function(a){this._b=parseInt(255*e.Clamp(a,0,1))}),f.prototype.__defineGetter__("color",function(){return this._r<<16|this._g<<8|this._b}),f.prototype._r=0,f.prototype._g=0,f.prototype._b=0,f.prototype.set=f.prototype.Set,b.exports=f},z:function(a,b,c,d){var e=a("1"),f=function(){this.__varz(),this.__constructor.apply(this,arguments)};f.prototype.__constructor=function(){},f.prototype.__varz=function(){this.normal=new e},f.prototype.normal=new e,f.prototype.fraction=null,b.exports=f},10:function(a,b,c,d){var e=a("1"),f=a("4"),g=a("3"),h=a("b"),i=a("d"),j=a("2"),k=function(){b2Shape.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)};extend(k.prototype,b2Shape.prototype),k.prototype._super=b2Shape.prototype,k.prototype.__constructor=function(){this._super.__constructor.apply(this,arguments),this.m_type=b2Shape.e_polygonShape,this.m_centroid=new e,this.m_vertices=new Array,this.m_normals=new Array},k.prototype.__varz=function(){},k.AsArray=function(a,b){var c=new k;return c.SetAsArray(a,b),c},k.AsVector=function(a,b){var c=new k;return c.SetAsVector(a,b),c},k.AsBox=function(a,b){var c=new k;return c.SetAsBox(a,b),c},k.AsOrientedBox=function(a,b,c,d){var e=new k;return e.SetAsOrientedBox(a,b,c,d),e},k.AsEdge=function(a,b){var c=new k;return c.SetAsEdge(a,b),c},k.ComputeCentroid=function(a,b){var c=new e,d=0,f=0,g=0,h=1/3;for(var i=0;i<b;++i){var j=a[i],k=i+1<b?a[parseInt(i+1)]:a[0],l=j.x-f,m=j.y-g,n=k.x-f,o=k.y-g,p=l*o-m*n,q=.5*p;d+=q,c.x+=q*h*(f+j.x+k.x),c.y+=q*h*(g+j.y+k.y)}return c.x*=1/d,c.y*=1/d,c},k.ComputeOBB=function(a,b,c){var d=0,e=new Array(c+1);for(d=0;d<c;++d)e[d]=b[d];e[c]=e[0];var f=Number.MAX_VALUE;for(d=1;d<=c;++d){var g=e[parseInt(d-1)],h=e[d].x-g.x,i=e[d].y-g.y,j=Math.sqrt(h*h+i*i);h/=j,i/=j;var k=-i,l=h,m=Number.MAX_VALUE,n=Number.MAX_VALUE,o=-Number.MAX_VALUE,p=-Number.MAX_VALUE;for(var q=0;q<c;++q){var r=e[q].x-g.x,s=e[q].y-g.y,t=h*r+i*s,u=k*r+l*s;t<m&&(m=t),u<n&&(n=u),t>o&&(o=t),u>p&&(p=u)}var v=(o-m)*(p-n);if(v<.95*f){f=v,a.R.col1.x=h,a.R.col1.y=i,a.R.col2.x=k,a.R.col2.y=l;var w=.5*(m+o),x=.5*(n+p),y=a.R;a.center.x=g.x+(y.col1.x*w+y.col2.x*x),a.center.y=g.y+(y.col1.y*w+y.col2.y*x),a.extents.x=.5*(o-m),a.extents.y=.5*(p-n)}}},k.s_mat=new f,k.prototype.Validate=function(){return!1},k.prototype.Reserve=function(a){for(var b=this.m_vertices.length;b<a;b++)this.m_vertices[b]=new e,this.m_normals[b]=new e},k.prototype.Copy=function(){var a=new k;return a.Set(this),a},k.prototype.Set=function(a){this._super.Set.apply(this,[a]);if(isInstanceOf(a,k)){var b=a;this.m_centroid.SetV(b.m_centroid),this.m_vertexCount=b.m_vertexCount,this.Reserve(this.m_vertexCount);for(var c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(b.m_vertices[c]),this.m_normals[c].SetV(b.m_normals[c])}},k.prototype.SetAsArray=function(a,b){var c=new Array;for(var d=0,e=null;d<a.length,e=a[d];d++)c.push(e);this.SetAsVector(c,b)},k.prototype.SetAsVector=function(a,b){typeof b=="undefined"&&(b=a.length),i.b2Assert(2<=b),this.m_vertexCount=b,this.Reserve(b);var c=0;for(c=0;c<this.m_vertexCount;c++)this.m_vertices[c].SetV(a[c]);for(c=0;c<this.m_vertexCount;++c){var d=c,e=c+1<this.m_vertexCount?c+1:0,f=j.SubtractVV(this.m_vertices[e],this.m_vertices[d]);i.b2Assert(f.LengthSquared()>Number.MIN_VALUE),this.m_normals[c].SetV(j.CrossVF(f,1)),this.m_normals[c].Normalize()}this.m_centroid=k.ComputeCentroid(this.m_vertices,this.m_vertexCount)},k.prototype.SetAsBox=function(a,b){this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-a,-b),this.m_vertices[1].Set(a,-b),this.m_vertices[2].Set(a,b),this.m_vertices[3].Set(-a,b),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()},k.prototype.SetAsOrientedBox=function(a,b,c,d){this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-a,-b),this.m_vertices[1].Set(a,-b),this.m_vertices[2].Set(a,b),this.m_vertices[3].Set(-a,b),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=c;var e=new g;e.position=c,e.R.Set(d);for(var f=0;f<this.m_vertexCount;++f)this.m_vertices[f]=j.MulX(e,this.m_vertices[f]),this.m_normals[f]=j.MulMV(e.R,this.m_normals[f])},k.prototype.SetAsEdge=function(a,b){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(a),this.m_vertices[1].SetV(b),this.m_centroid.x=.5*(a.x+b.x),this.m_centroid.y=.5*(a.y+b.y),this.m_normals[0]=j.CrossVF(j.SubtractVV(b,a),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y},k.prototype.TestPoint=function(a,b){var c,d=a.R,e=b.x-a.position.x,f=b.y-a.position.y,g=e*d.col1.x+f*d.col1.y,h=e*d.col2.x+f*d.col2.y;for(var i=0;i<this.m_vertexCount;++i){c=this.m_vertices[i],e=g-c.x,f=h-c.y,c=this.m_normals[i];var j=c.x*e+c.y*f;if(j>0)return!1}return!0},k.prototype.RayCast=function(a,b,c){var d=0,e=b.maxFraction,f,g,h,i;f=b.p1.x-c.position.x,g=b.p1.y-c.position.y,h=c.R;var j=f*h.col1.x+g*h.col1.y,k=f*h.col2.x+g*h.col2.y;f=b.p2.x-c.position.x,g=b.p2.y-c.position.y,h=c.R;var l=f*h.col1.x+g*h.col1.y,m=f*h.col2.x+g*h.col2.y,n=l-j,o=m-k,p=-1;for(var q=0;q<this.m_vertexCount;++q){i=this.m_vertices[q],f=i.x-j,g=i.y-k,i=this.m_normals[q];var r=i.x*f+i.y*g,s=i.x*n+i.y*o;if(s==0){if(r<0)return!1}else s<0&&r<d*s?(d=r/s,p=q):s>0&&r<e*s&&(e=r/s);if(e<d-Number.MIN_VALUE)return!1}return p>=0?(a.fraction=d,h=c.R,i=this.m_normals[p],a.normal.x=h.col1.x*i.x+h.col2.x*i.y,a.normal.y=h.col1.y*i.x+h.col2.y*i.y,!0):!1},k.prototype.ComputeAABB=function(a,b){var c=b.R,d=this.m_vertices[0],e=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),f=b.position.y+(c.col1.y*d.x+c.col2.y*d.y),g=e,h=f;for(var i=1;i<this.m_vertexCount;++i){d=this.m_vertices[i];var j=b.position.x+(c.col1.x*d.x+c.col2.x*d.y),k=b.position.y+(c.col1.y*d.x+c.col2.y*d.y);e=e<j?e:j,f=f<k?f:k,g=g>j?g:j,h=h>k?h:k}a.lowerBound.x=e-this.m_radius,a.lowerBound.y=f-this.m_radius,a.upperBound.x=g+this.m_radius,a.upperBound.y=h+this.m_radius},k.prototype.ComputeMass=function(a,b){if(this.m_vertexCount==2){a.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),a.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),a.mass=0,a.I=0;return}var c=0,d=0,e=0,f=0,g=0,h=0,i=1/3;for(var j=0;j<this.m_vertexCount;++j){var k=this.m_vertices[j],l=j+1<this.m_vertexCount?this.m_vertices[parseInt(j+1)]:this.m_vertices[0],m=k.x-g,n=k.y-h,o=l.x-g,p=l.y-h,q=m*p-n*o,r=.5*q;e+=r,c+=r*i*(g+k.x+l.x),d+=r*i*(h+k.y+l.y);var s=g,t=h,u=m,v=n,w=o,x=p,y=i*(.25*(u*u+w*u+w*w)+(s*u+s*w))+.5*s*s,z=i*(.25*(v*v+x*v+x*x)+(t*v+t*x))+.5*t*t;f+=q*(y+z)}a.mass=b*e,c*=1/e,d*=1/e,a.center.Set(c,d),a.I=b*f},k.prototype.ComputeSubmergedArea=function(a,b,c,d){var f=j.MulTMV(c.R,a),g=b-j.Dot(a,c.position),i=new Array,k=0,l=-1,m=-1,n=!1,o=0;for(o=0;o<this.m_vertexCount;++o){i[o]=j.Dot(f,this.m_vertices[o])-g;var p=i[o]<-Number.MIN_VALUE;o>0&&(p?n||(l=o-1,k++):n&&(m=o-1,k++)),n=p}switch(k){case 0:if(n){var q=new h;return this.ComputeMass(q,1),d.SetV(j.MulX(c,q.center)),q.mass}return 0;case 1:l==-1?l=this.m_vertexCount-1:m=this.m_vertexCount-1}var r=(l+1)%this.m_vertexCount,s=(m+1)%this.m_vertexCount,t=(0-i[l])/(i[r]-i[l]),u=(0-i[m])/(i[s]-i[m]),v=new e(this.m_vertices[l].x*(1-t)+this.m_vertices[r].x*t,this.m_vertices[l].y*(1-t)+this.m_vertices[r].y*t),w=new e(this.m_vertices[m].x*(1-u)+this.m_vertices[s].x*u,this.m_vertices[m].y*(1-u)+this.m_vertices[s].y*u),x=0,y=new e,z=this.m_vertices[r],A;o=r;while(o!=s){o=(o+1)%this.m_vertexCount,o==s?A=w:A=this.m_vertices[o];var B=.5*((z.x-v.x)*(A.y-v.y)-(z.y-v.y)*(A.x-v.x));x+=B,y.x+=B*(v.x+z.x+A.x)/3,y.y+=B*(v.y+z.y+A.y)/3,z=A}return y.Multiply(1/x),d.SetV(j.MulX(c,y)),x},k.prototype.GetVertexCount=function(){return this.m_vertexCount},k.prototype.GetVertices=function(){return this.m_vertices},k.prototype.GetNormals=function(){return this.m_normals},k.prototype.GetSupport=function(a){var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y;for(var d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return b},k.prototype.GetSupportVertex=function(a){var b=0,c=this.m_vertices[0].x*a.x+this.m_vertices[0].y*a.y;for(var d=1;d<this.m_vertexCount;++d){var e=this.m_vertices[d].x*a.x+this.m_vertices[d].y*a.y;e>c&&(b=d,c=e)}return this.m_vertices[b]},k.prototype.m_centroid=null,k.prototype.m_vertices=null,k.prototype.m_normals=null,k.prototype.m_vertexCount=0,k.prototype.validate=k.prototype.Validate,k.prototype.reserve=k.prototype.Reserve,k.prototype.copy=k.prototype.Copy,k.prototype.set=k.prototype.Set,k.prototype.setAsArray=k.prototype.SetAsArray,k.prototype.setAsVector=k.prototype.SetAsVector,k.prototype.setAsBox=k.prototype.SetAsBox,k.prototype.setAsOrientedBox=k.prototype.SetAsOrientedBox,k.prototype.setAsEdge=k.prototype.SetAsEdge,k.prototype.testPoint=k.prototype.TestPoint,k.prototype.rayCast=k.prototype.RayCast,k.prototype.computeAABB=k.prototype.ComputeAABB,k.prototype.computeMass=k.prototype.ComputeMass,k.prototype.computeSubmergedArea=k.prototype.ComputeSubmergedArea,k.prototype.getVertexCount=k.prototype.GetVertexCount,k.prototype.getVertices=k.prototype.GetVertices,k.prototype.getNormals=k.prototype.GetNormals,k.prototype.getSupport=k.prototype.GetSupport,k.prototype.getSupportVertex=k.prototype.GetSupportVertex,b.exports=k},11:function(a,b,c,d){var e=a("1"),f=a("d"),g=a("2"),h=function(){b2Shape.prototype.__varz.call(this),this.__varz(),this.__constructor.apply(this,arguments)};extend(h.prototype,b2Shape.prototype),h.prototype._super=b2Shape.prototype,h.prototype.__constructor=function(a){this._super.__constructor.apply(this,[]),this.m_type=b2Shape.e_circleShape,this.m_radius=a},h.prototype.__varz=function(){this.m_p=new e},h.prototype.Copy=function(){var a=new h;return a.Set(this),a},h.prototype.Set=function(a){this._super.Set.apply(this,[a]);if(isInstanceOf(a,h)){var b=a;this.m_p.SetV(b.m_p)}},h.prototype.TestPoint=function(a,b){var c=a.R,d=a.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),e=a.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);return d=b.x-d,e=b.y-e,d*d+e*e<=this.m_radius*this.m_radius},h.prototype.RayCast=function(a,b,c){var d=c.R,e=c.position.x+(d.col1.x*this.m_p.x+d.col2.x*this.m_p.y),f=c.position.y+(d.col1.y*this.m_p.x+d.col2.y*this.m_p.y),g=b.p1.x-e,h=b.p1.y-f,i=g*g+h*h-this.m_radius*this.m_radius,j=b.p2.x-b.p1.x,k=b.p2.y-b.p1.y,l=g*j+h*k,m=j*j+k*k,n=l*l-m*i;if(n<0||m<Number.MIN_VALUE)return!1;var o=-(l+Math.sqrt(n));return 0<=o&&o<=b.maxFraction*m?(o/=m,a.fraction=o,a.normal.x=g+o*j,a.normal.y=h+o*k,a.normal.Normalize(),!0):!1},h.prototype.ComputeAABB=function(a,b){var c=b.R,d=b.position.x+(c.col1.x*this.m_p.x+c.col2.x*this.m_p.y),e=b.position.y+(c.col1.y*this.m_p.x+c.col2.y*this.m_p.y);a.lowerBound.Set(d-this.m_radius,e-this.m_radius),a.upperBound.Set(d+this.m_radius,e+this.m_radius)},h.prototype.ComputeMass=function(a,b){a.mass=b*f.b2_pi*this.m_radius*this.m_radius,a.center.SetV(this.m_p),a.I=a.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))},h.prototype.ComputeSubmergedArea=function(a,b,c,d){var e=g.MulX(c,this.m_p),f=-(g.Dot(a,e)-b);if(f<-this.m_radius+Number.MIN_VALUE)return 0;if(f>this.m_radius)return d.SetV(e),Math.PI*this.m_radius*this.m_radius;var h=this.m_radius*this.m_radius,i=f*f,j=h*(Math.asin(f/this.m_radius)+Math.PI/2)+f*Math.sqrt(h-i),k=-2/3*Math.pow(h-i,1.5)/j;return d.x=e.x+a.x*k,d.y=e.y+a.y*k,j},h.prototype.GetLocalPosition=function(){return this.m_p},h.prototype.SetLocalPosition=function(a){this.m_p.SetV(a)},h.prototype.GetRadius=function(){return this.m_radius},h.prototype.SetRadius=function(a){this.m_radius=a},h.prototype.m_p=new e,h.prototype.copy=h.prototype.Copy,h.prototype.set=h.prototype.Set,h.prototype.testPoint=h.prototype.TestPoint,h.prototype.rayCast=h.prototype.RayCast,h.prototype.computeAABB=h.prototype.ComputeAABB,h.prototype.computeMass=h.prototype.ComputeMass,h.prototype.computeSubmergedArea=h.prototype.ComputeSubmergedArea,h.prototype.getLocalPosition=h.prototype.GetLocalPosition,h.prototype.setLocalPosition=h.prototype.SetLocalPosition,h.prototype.getRadius=h.prototype.GetRadius,h.prototype.setRadius=h.prototype.SetRadius,b.exports=h},12:function(a,b,c,d){var e=a("1"),f=a("y"),g=function(){this.__varz(),this.__constructor.apply(this,arguments)};g.prototype.__constructor=function(){this.m_drawFlags=0},g.prototype.__varz=function(){},g.e_shapeBit=1,g.e_jointBit=2,g.e_aabbBit=4,g.e_pairBit=8,g.e_centerOfMassBit=16,g.e_controllerBit=32,g.prototype.SetFlags=function(a){this.m_drawFlags=a},g.prototype.GetFlags=function(){return this.m_drawFlags},g.prototype.AppendFlags=function(a){this.m_drawFlags|=a},g.prototype.ClearFlags=function(a){this.m_drawFlags&=~a},g.prototype.SetSprite=function(a){this.m_sprite=a},g.prototype.GetSprite=function(){return this.m_sprite},g.prototype.SetDrawScale=function(a){this.m_drawScale=a},g.prototype.GetDrawScale=function(){return this.m_drawScale},g.prototype.SetLineThickness=function(a){this.m_lineThickness=a},g.prototype.GetLineThickness=function(){return this.m_lineThickness},g.prototype.SetAlpha=function(a){this.m_alpha=a},g.prototype.GetAlpha=function(){return this.m_alpha},g.prototype.SetFillAlpha=function(a){this.m_fillAlpha=a},g.prototype.GetFillAlpha=function(){return this.m_fillAlpha},g.prototype.SetXFormScale=function(a){this.m_xformScale=a},g.prototype.GetXFormScale=function(){return this.m_xformScale},g.prototype.Clear=function(){this.m_sprite.clearRect(0,0,this.m_sprite.canvas.width,this.m_sprite.canvas.height)},g.prototype.Y=function(a){return this.m_sprite.canvas.height-a},g.prototype.ToWorldPoint=function(a){return new e(a.x/this.m_drawScale,this.Y(a.y)/this.m_drawScale)},g.prototype.ColorStyle=function(a,b){return"rgba("+a.r+", "+a.g+", "+a.b+", "+b+")"},g.prototype.DrawPolygon=function(a,b,c){this.m_sprite.graphics.lineStyle(this.m_lineThickness,c.color,this.m_alpha),this.m_sprite.graphics.moveTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale);for(var d=1;d<b;d++)this.m_sprite.graphics.lineTo(a[d].x*this.m_drawScale,a[d].y*this.m_drawScale);this.m_sprite.graphics.lineTo(a[0].x*this.m_drawScale,a[0].y*this.m_drawScale)},g.prototype.DrawSolidPolygon=function(a,b,c){this.m_sprite.strokeSyle=this.ColorStyle(c,this.m_alpha),this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.fillStyle=this.ColorStyle(c,this.m_fillAlpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a[0].x*this.m_drawScale,this.Y(a[0].y*this.m_drawScale));for(var d=1;d<b;d++)this.m_sprite.lineTo(a[d].x*this.m_drawScale,this.Y(a[d].y*this.m_drawScale));this.m_sprite.lineTo(a[0].x*this.m_drawScale,this.Y(a[0].y*this.m_drawScale)),this.m_sprite.fill(),this.m_sprite.stroke(),this.m_sprite.closePath()},g.prototype.DrawCircle=function(a,b,c){this.m_sprite.graphics.lineStyle(this.m_lineThickness,c.color,this.m_alpha),this.m_sprite.graphics.drawCircle(a.x*this.m_drawScale,a.y*this.m_drawScale,b*this.m_drawScale)},g.prototype.DrawSolidCircle=function(a,b,c,d){this.m_sprite.strokeSyle=this.ColorStyle(d,this.m_alpha),this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.fillStyle=this.ColorStyle(d,this.m_fillAlpha),this.m_sprite.beginPath(),this.m_sprite.arc(a.x*this.m_drawScale,this.Y(a.y*this.m_drawScale),b*this.m_drawScale,0,Math.PI*2,!0),this.m_sprite.fill(),this.m_sprite.stroke(),this.m_sprite.closePath()},g.prototype.DrawSegment=function(a,b,c){this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.strokeSyle=this.ColorStyle(c,this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.x*this.m_drawScale,this.Y(a.y*this.m_drawScale)),this.m_sprite.lineTo(b.x*this.m_drawScale,this.Y(b.y*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath()},g.prototype.DrawTransform=function(a){this.m_sprite.lineWidth=this.m_lineThickness,this.m_sprite.strokeSyle=this.ColorStyle(new f(255,0,0),this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.position.x*this.m_drawScale,this.Y(a.position.y*this.m_drawScale)),this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col1.x)*this.m_drawScale,this.Y((a.position.y+this.m_xformScale*a.R.col1.y)*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath(),this.m_sprite.strokeSyle=this.ColorStyle(new f(0,255,0),this.m_alpha),this.m_sprite.beginPath(),this.m_sprite.moveTo(a.position.x*this.m_drawScale,this.Y(a.position.y*this.m_drawScale)),this.m_sprite.lineTo((a.position.x+this.m_xformScale*a.R.col2.x)*this.m_drawScale,this.Y((a.position.y+this.m_xformScale*a.R.col2.y)*this.m_drawScale)),this.m_sprite.stroke(),this.m_sprite.closePath()},g.prototype.m_drawFlags=0,g.prototype.m_sprite=null,g.prototype.m_drawScale=1,g.prototype.m_lineThickness=1,g.prototype.m_alpha=1,g.prototype.m_fillAlpha=1,g.prototype.m_xformScale=1,g.prototype.setFlags=g.prototype.SetFlags,g.prototype.getFlags=g.prototype.GetFlags,g.prototype.appendFlags=g.prototype.AppendFlags,g.prototype.clearFlags=g.prototype.ClearFlags,g.prototype.setSprite=g.prototype.SetSprite,g.prototype.getSprite=g.prototype.GetSprite,g.prototype.setDrawScale=g.prototype.SetDrawScale,g.prototype.getDrawScale=g.prototype.GetDrawScale,g.prototype.setLineThickness=g.prototype.SetLineThickness,g.prototype.getLineThickness=g.prototype.GetLineThickness,g.prototype.setAlpha=g.prototype.SetAlpha,g.prototype.getAlpha=g.prototype.GetAlpha,g.prototype.setFillAlpha=g.prototype.SetFillAlpha,g.prototype.getFillAlpha=g.prototype.GetFillAlpha,g.prototype.setXFormScale=g.prototype.SetXFormScale,g.prototype.getXFormScale=g.prototype.GetXFormScale,g.prototype.clear=g.prototype.Clear,g.prototype.y=g.prototype.Y,g.prototype.toWorldPoint=g.prototype.ToWorldPoint,g.prototype.colorStyle=g.prototype.ColorStyle,g.prototype.drawPolygon=g.prototype.DrawPolygon,g.prototype.drawSolidPolygon=g.prototype.DrawSolidPolygon,g.prototype.drawCircle=g.prototype.DrawCircle,g.prototype.drawSolidCircle=g.prototype.DrawSolidCircle,g.prototype.drawSegment=g.prototype.DrawSegment,g.prototype.drawTransform=g.prototype.DrawTransform,b.exports=g}})
